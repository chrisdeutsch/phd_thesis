\label{sec:hadhad_multijet}

% \todo[inline]{Maybe say that we perform some tricks to go from
%   ``event-level'' fake factors to ``tau-level'' fake factors?}

Multi-jet production is a source of background in the \hadhad SR where both
\tauhadvis candidates originate from the misidentification of quark- or
gluon-initiated jets. It represents the second largest background with
\faketauhadvis in the \hadhad SR after the dominant \ttbarFakes contribution.

\subsubsection{The fake factor method}

The multi-jet background is estimated with the data-driven fake factor
method. It is applicable in cases where two observables exist that are
statistically independent for the background process to be estimated while also
being strong discriminators between the background and other processes (signal
and non-multi-jet processes). Four disjoint regions can be defined, three
background-enriched CRs and a signal-like region, by categorising events based
on both observables. The assumption of statistical independence allows to relate
the expected number of events for the background process between control regions
and the signal-like region, allowing to estimate the background in the
signal-like region using data observed in the control regions.

In the \hadhad channel, two observables that allow to define CRs enriched in
multi-jet events are the \tauid requirements fulfilled by the \tauhadvis
candidates and the sign of the electric charges of both candidates.

In the SR, \tauhadvis candidates are required to pass the loose \tauid working
point. This requirement defines regions where both \tauhadvis candidates pass
identification, hereafter referred to as ID regions. The selection is partially
inverted to obtain control regions enhanced in multi-jet events by requiring
that exactly one \tauhadvis candidate is failing the loose \tauid working point
while still passing a working point corresponding to a true \tauhadvis
identification efficiency of about \SI{99}{\percent}
($\text{RNN score} > 0.01$). The \tauhadvis candidates fulfilling this selection
are referred to as anti-\tauhadvis and the regions defined by the inversion of
the identification criterion as Anti-ID regions. The identification criterion
cannot be fully inverted due to a pre-selection applied in the data reduction
pipeline of the ATLAS experiment.\footnote{Datasets targeting
  $\PHiggs \to \hadhad$ require events with at least one \tauhadvis passing the
  loose \tauid working point and one \tauhadvis with a \tauid score exceeding
  0.01.}  However, the fake factor method is still valid in the presence of
these constraints provided the underlying assumptions of the method hold.

The electric charge of \tauhadvis candidates produced in signal or
backgrounds processes with two \tauhadvis from hadronic decays of
\tauleptons (e.g.\ $\PZ \to \tautau$, $\PHiggs \to \tautau$, \ttbar)
are expected to be reconstructed with opposite-sign (OS). The OS
requirement is inverted yielding regions with \tauhadvis candidates of
same-sign (SS) electric charge, depleting the region of processes
where both \tauhadvis originate from hadronic \taulepton decays. In
contrast, the multi-jet background contributes similarly to the OS and
SS regions since \tauhadvis charge reconstruction has little
sensitivity to the relative sign of the electric charge between a pair
of partons initiating jets that are misidentified as \tauhadvis.

With the previously defined control regions and the assumption of
independence of the observables defining the regions, the expected
multi-jet contribution in regions with \tauhadvis passing loose
identification and with \tauhadvis pairs of opposite-sign electric
charge can be estimated using
\begin{align*}
  N_\text{multi-jet}^{\text{OS, ID}} =
  N_\text{multi-jet}^{\text{OS, Anti-ID}}
  \cdot
  \underbrace{\frac{N_\text{multi-jet}^{\text{SS, ID}}}
  {N_\text{multi-jet}^{\text{SS, Anti-ID}}}}
  _{= \text{FF}_{\text{SS}}} \,\text{,}
\end{align*}
where $N_\text{multi-jet}$ is the number of multi-jet events in a
given region. The fake factor (FF) measures the ratio of multi-jet
events in the ID and Anti-ID region.% \footnote{The use of identification
% or isolation criteria to defining the ratio is the main difference
% between the fake factor method and the more general ABCD method.}

The control regions defined by inverting the OS and/or ID requirements
on \tauhadvis do not provide pure samples of multi-jet
events. Therefore, the number of multi-jet events is estimated
according to
\begin{align*}
  N_\text{multi-jet} = N_\text{data} - N_\text{non-multi-jet} \,\text{,}
\end{align*}
where $N_\text{data}$ is the observed number of events in the
multi-jet enriched region and $N_\text{non-multi-jet}$ the expected
number of non-multi-jet events estimated using simulation.

The probability of misidentifying a quark- or gluon-initiated jet as a
\tauhadvis depends on the properties of the reconstructed \tauhadvis
candidate. Particularly, the reconstructed decay mode and visible
transverse momentum affect the probability of a jet reconstructed as a
\tauhadvis to pass \tauid. To control for this effect, fake factors
are derived in bins of \tauhadvis candidate properties.

In~\Cref{tab:mjfakes_yields} the expected multi-jet and non-multi-jet
event yields in the regions relevant for the \faketauhadvis estimation
are summarised. The 2 $b$-tag region, while most similar to the signal
region, is not well suited to estimate fake factors:
\begin{itemize}

\item The 2 $b$-tag regions relevant for the fake factor measurement
  have a large contributions from non-multi-jet sources, primarily
  \ttbarFakes, that have to be subtracted. The large size of the
  subtraction leads to a degradation of the statistical precision of
  the fake factors and an increase in systematic uncertainties from
  modelling uncertainties on the subtracted components.

\item The strict \btag requirement suppresses the multi-jet
  contribution in the control regions preventing a differential
  measurement of fake factors in properties of the \tauhadvis.

\item The multi-jet estimate cannot be validated in the 2 $b$-tag
  region due to the absence of a region with high multi-jet purity
  that is similar to the signal region.

  % Resultingly, the statistical independence of the charge sign and ID
  % observables employed by the FF method cannot be verified.
\end{itemize}
These issues are partially addressed by performing the fake factor
measurement in the 1 $b$-tag region instead, which has a higher
abundance and purity of multi-jet events, and extrapolating the
measurement into the 2 $b$-tag region to obtain a multi-jet background
estimate in the signal region. Distributions of the \pT of the leading
and sub-leading \tauhadvis candidates in the regions relevant to the
fake factor measurement are shown in~\Cref{fig:mjfakes_1tag_ss_plots}.

\begin{table}[htbp]
  \centering

  \caption{Expected number of multi-jet events in regions defined by
    the electric charge of the \tauhadvis pair (OS/SS) and \tauhadvis
    identification (ID/Anti-ID). The expected number of multi-jet
    events, $N_\text{multi-jet}$, is estimated by subtracting the
    expected number of non-multi-jet events, $N_\text{non-multi-jet}$,
    from the observed number of events in a given region. The
    breakdown is shown after the 1 $b$-tag requirement in (a); after
    the 2 $b$-tag requirement in (b). The signal region (2 $b$-tag OS
    ID) is omitted. Only statistical uncertainties on the expected
    event yields are shown.}%
  \label{tab:mjfakes_yields}

  \begin{subtable}[t]{\textwidth}
    \centering

    \subcaption{1 $b$-tag regions}
    \label{tab:mjfakes_yields_1tag}

    \input{tables/mjfakes_yield_table_1tag}
  \end{subtable}

  \vspace{11pt}

  \begin{subtable}[t]{\textwidth}
    \centering

    \subcaption{2 $b$-tag regions}

    \input{tables/mjfakes_yield_table_2tag}
  \end{subtable}
\end{table}

\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/region_plots/tau0pt_1tag_ss_id}
    \subcaption{1 $b$-tag SS ID region}
  \end{subfigure}
  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/region_plots/tau1pt_1tag_ss_id}
    \subcaption{1 $b$-tag SS ID region}
  \end{subfigure}

  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/region_plots/tau0pt_1tag_ss_antiid}
    \subcaption{1 $b$-tag SS Anti-ID region}
  \end{subfigure}
  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/region_plots/tau1pt_1tag_ss_antiid}
    \subcaption{1 $b$-tag SS Anti-ID region}
  \end{subfigure}

  \caption{Distribution of leading and sub-leading \tauhadvis \pT for
    observed data and non-multi-jet backgrounds in regions used for
    the fake factor measurement. The 1 $b$-tag SS ID region is shown
    in (a,b) and the 1 $b$-tag SS Anti-ID region in (c,d). Coloured
    histograms depict the contributions of non-multi-jet processes
    that are subtracted when estimating the fake factors. The
    difference between the observed data and the non-multi-jet
    background estimate is attributed to the missing multi-jet
    background. All regions are shown after the pre-selection, the SS
    region yields and multi-jet purities corresponding to the values
    listed in~\Cref{tab:mjfakes_yields_1tag}.}%
  \label{fig:mjfakes_1tag_ss_plots}
\end{figure}

A schematic illustration of the approach is given
in~\Cref{fig:fakefactor_regions}. Fake factors measured in the 1
$b$-tag SS regions ($\text{FF}_\text{SS}^\text{1-tag}$) are applied to
events in the 2 $b$-tag OS Anti-ID region after subtraction of
non-multi-jet contributions to obtain an estimate of the multi-jet
background in the signal region. Multiplicative transfer factors
($\text{TF}_{1 \ra 2\,b\text{-tag}}$) are applied to
$\text{FF}_\text{SS}^\text{1-tag}$ when used in 2 $b$-tag regions,
accounting for possible differences between fake factors measured in 1
and 2 $b$-tag regions and the uncertainties associated with this
extrapolation.

\begin{figure}[htbp]
  \centering

  \includegraphics[scale=1]{fakefactors/regions}

  \caption{Schematic description of the fake factor method employed to
    estimate the multi-jet background in the signal region of the
    \hadhad channel. The squares represent the multi-jet events
    ($N_\text{multi-jet} = N_\text{data} - N_\text{non-multi-jet}$) in
    a particular region. The red / blue arrows correspond to fake
    factors calculated as the ratio of multi-jet events in ID and
    Anti-ID regions. Black arrows correspond to the application of
    fake factors in the OS Anti-ID region to obtain the multi-jet
    template in the OS ID region.}
  \label{fig:fakefactor_regions}
\end{figure}

The 1 $b$-tag OS ID region serves as a validation region to check the
agreement of the total background prediction with the observed
data. Any non-closure observed in this region indicates either a
violation of the assumptions of the fake factor method, or
dependencies that are not captured by the parameterisation of the fake
factors.

% % verify the independence of the observables related to \tauid and
% % electric charge of the \tauhadvis pair.
% This approach is equivalent to a comparison of fake factors measured
% in the OS and SS regions\footnote{\Cref{tab:mjfakes_yields_1tag} can
%   be used to calculate inclusive fake factors in the OS and SS
%   regions, yielding
%   $\text{FF}_\text{SS}^\text{1-tag} \approx
%   \text{FF}_\text{OS}^\text{1-tag} \approx 0.18$, which is a
%   sufficient condition for statistical independence of the fake factor
%   observables at the level of the inclusive selection.}, which have to
% agree under the assumptions of the method.\todo{Needs some work...}


\subsubsection{Measurement of fake factors}

% Binning in years / trigger
The fake factor measurement is performed separately for events
selected by single- and di-\tauhadvis triggers and separately for
different data collection periods. The \tauhadvis triggers changed as
Run~2 of the LHC progressed, selecting events of different topologies
and altering the algorithms used for reconstruction and identification
of \tauhadvis at the HLT. To account for potential differences in fake
factors from these changes, the measurement is performed separately
for three major data collection periods: 2015--2016, 2017, and 2018.

% Reason for binning in
The categorisation of the fake factors by trigger that selected the
event is further motivated by the differences between both trigger
categories. Single-\tauhadvis triggers require one \tauhadvis
candidate with high transverse momentum that is identified at the HLT
without any selections applied to the other candidate. In contrast,
di-\tauhadvis triggers require two \tauhadvis to be identified at the
HLT with similar transverse momentum thresholds applied to both. This
allows \tauhadvis candidates in the di-\tauhadvis trigger category to
be treated equally once \pT-threshold effects are accounted
for. % This is not the case for
% events selected by single-\tauhadvis triggers.

Dependencies of fake factors on properties of reconstructed \tauhadvis
are accounted for by further categorisation based on properties of the
(anti-)\tauhadvis that distinguishes the ID from the Anti-ID
regions. The fake factor measurement is performed separately for 1-
and 3-prong \tauhadvis candidates for both trigger categories.

Fake factors for events selected by di-\tauhadvis triggers are
additionally measured in bins of \tauhadvis~\pT and separately for
\tauhadvis in the barrel and end-cap regions of the detector. In
contrast, few multi-jet events are selected by single-\tauhadvis
triggers due to high \pT thresholds on \tauhadvis preventing fine
subdivision of the fake factor measurement. Therefore, fake factors
for events selected by single-\tauhadvis triggers are measured
separately for cases where the anti-\tauhadvis is leading and
sub-leading in \pT. This accounts for the \tauid applied at the HLT
and the transverse momentum differences between the leading and
sub-leading \tauhadvis~candidates.


\subsubsection{Measurement of fake factors for events selected by
  di-\tauhadvis triggers}

{% Group for extra definitions
  \newcommand*{\ffargs}{\ensuremath{( \myvec{x}_{\tau} )}\xspace}

  \newcommand*{\NmjID}[2]{\ensuremath{N_\text{multi-jet}^{\text{#1, loose }\tau_{#2}}}\xspace}
  \newcommand*{\NmjIDIncl}[1]{\ensuremath{N_\text{multi-jet}^{\text{#1, ID}}}\xspace}

  \newcommand*{\NmjAntiIDIncl}[1]{\ensuremath{N_\text{multi-jet}^{\text{#1, Anti-ID}}}\xspace}
  \newcommand*{\NmjAntiID}[2]{\ensuremath{N_\text{multi-jet}^{\text{#1, anti-}\tau_{#2}}}\xspace}

  The Anti-ID region can be partitioned into two sub-regions: one
  where the anti-\tauhadvis is the leading and one where it is the
  sub-leading \tauhadvis candidate. Provided the conditions for the
  fake factor method are fulfilled, both regions can be used to obtain
  separate estimates of the multi-jet background in the OS ID
  region. The notation used to describe the fake factor measurement is
  introduced in the following:
  \begin{description}[style=standard]
  \item[$\tau_0$ ($\tau_1$)] The \tauhadvis candidate leading (sub-leading) in \pT.

  \item[$\myvec{x}_\tau$] A vector of categorical observables of
    \tauhadvis that specifies the bin of the fake factor
    measurement. For the di-\tauhadvis trigger category these
    correspond to bins in \Ntracks, \pT, and $\eta$.
    % The measurement in the di-\tauhadvis trigger category
    % is performed separately for 1- and 3-prong \tauhadvis, and in bins
    % of \tauhadvis \pT and $\eta$.

  \item[$\NmjID{SS(OS)}{i}\ffargs$] The estimated number of multi-jet
    events in the SS (OS) ID region where~$\tau_i$ falls into the bin
    specified by~$\myvec{x}_\tau$.

  \item[$\NmjAntiID{SS(OS)}{i}\ffargs$] The estimated number of
    multi-jet events in the SS (OS) Anti-ID region where $\tau_i$ is
    the anti-\tauhadvis and falls into the bin specified
    by~$\myvec{x}_\tau$.
  \end{description}
  With these definitions, two sets of fake factors can be defined as
  \begin{align*}
    \FF_{i}\ffargs &= \frac{\NmjID{SS}{i} \ffargs}{\NmjAntiID{SS}{i}\ffargs}
                     \quad \text{for} \quad i = 0, 1 \,\text{,}
  \end{align*}
  where $\FF_{i}$ is the fake factor relating the ID region with the
  partition of the Anti-ID region where $\tau_i$ is the
  anti-\tauhadvis. These can be used to obtain two multi-jet estimates
  in the OS region given by
  \begin{align*}
    \NmjID{OS}{i}\ffargs = \FF_{i}\ffargs \cdot \NmjAntiID{OS}{i}\ffargs
    \quad \text{for} \quad i = 0, 1 \,\text{.}
  \end{align*}
  The average of both estimates also yields an estimate of the
  multi-jet background. The process of averaging both estimates can be
  expressed by an alternative set of fake factors that do not
  distinguish in whether the anti-\tauhadvis is the leading or
  sub-leading \tauhadvis candidate, thus acting on the entirety of the
  Anti-ID region instead of a sub-region thereof. This inclusive fake
  factor is given by
  \begin{align*}
    \FF_\text{incl.}\ffargs = \frac{1}{2} \left[ f_0\ffargs \cdot \FF_0\ffargs
    + f_1\ffargs \cdot \FF_1\ffargs \right] \,\text{,}
  \end{align*}
  with $f_i\ffargs$ being the fraction of anti-\tauhadvis in the bin
  given by $\myvec{x}_\tau$ that are leading ($i = 0$) or sub-leading
  ($i = 1$) in \pT, formally given by
  \begin{align*}
    f_i\ffargs = \frac{\NmjAntiID{SS}{i}\ffargs}
                      {\NmjAntiID{SS}{0}\ffargs + \NmjAntiID{SS}{1}\ffargs} \,\text{.}
  \end{align*}
  The inclusive fake factor can be measured directly using the
  following relationship
  \begin{align}
    \FF_\text{incl.}\ffargs
    = \frac{1}{2} \frac{ \NmjID{SS}{0}\ffargs + \NmjID{SS}{1}\ffargs }
                       { \NmjAntiID{SS}{0}\ffargs + \NmjAntiID{SS}{1}\ffargs } \,\text{,}
    \label{eq:inclusive_fake_factor}
  \end{align}
  which can be applied to events in the inclusive Anti-ID region to
  obtain the multi-jet estimate in the ID region.

  % and the multi-jet estimate in the OS region obtained by\todo{Should there be a $\sum_{x_\tau}$ here?}
  % \begin{align*}
  %   \NmjIDIncl{OS}\ffargs = \FF_\text{incl.}\ffargs \cdot \NmjAntiIDIncl{OS}\ffargs \,\text{,}
  % \end{align*}
  % where $\NmjAntiIDIncl{OS}\ffargs$ is the number of multi-jet events
  % in the inclusive OS Anti-ID region with anti-\tauhadvis in the bin
  % given by~$\myvec{x}_\tau$.

  % Prior the agreement of the background estimates obtained with FF0
  % and FF1 were confirmed.

  The motivation of using the approach of defining inclusive fake
  factors is two-fold. First, it allows to use all events entering the
  Anti-ID region, independent of whether the anti-\tauhadvis is
  leading or sub-leading in \pT, thus improving the statistical
  precision of the background estimate. Second, the fake factors can
  be parameterised in properties of the anti-\tauhadvis directly,
  allowing to target the key differences between the ID and Anti-ID
  regions. This represents a change with respect to the previous
  publication~\cite{HIGG-2016-16-witherratum} where fake factors were
  parameterised jointly in the properties of both \tauhadvis candidates
  simultaneously, thus limiting %the statistical precision of
  the fake factor measurement due to high dimensionality of the
  parameterisation.}

The inclusive fake factors for events selected by di-\tauhadvis
triggers are measured according to~\Cref{eq:inclusive_fake_factor} and
parameterised in \tauhadvis decay mode, transverse momentum,
pseudorapidity, and the period of data collection. The number of
multi-jet events is obtained by subtracting the expected number of
non-multi-jet events estimated using simulation from the number of
observed events in data.

The result of the fake factor measurement for di-\tauhadvis triggers
is summarised in~\Cref{fig:mjfakes_fake_factors}. Qualitatively, the
behaviour of the fake factors with respect to \tauhadvis properties is
the same between data collection periods. Minor differences can be
observed when comparing fake factors between years. No attempt was
made to combine the measurements of certain periods as the statistical
precision of the fake factor measurement is not a limiting factor in
the analysis.

\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.495\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_factors_dtt_1516}
    \subcaption{2015--2016 data collection period}
  \end{subfigure}
  \begin{subfigure}{0.495\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_factors_dtt_17}
    \subcaption{2017 data collection period}
  \end{subfigure}

  \begin{subfigure}{0.495\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_factors_dtt_18}
    \subcaption{2018 data collection period}
  \end{subfigure}

  \caption{Di-\tauhadvis trigger fake factors measured in the 1
    $b$-tag SS region. The measurement is performed separately for the
    three major data collection periods (a-c), 1- and 3-prong
    \tauhadvis candidates (upper/lower panels), and for \tauhadvis in
    the barrel (red) and end-cap regions (blue) of the ATLAS
    detector. Events with (anti-)\tauhadvis $\pT > \SI{150}{\GeV}$ are
    included in the last fake factor bin. Uncertainties are from
    statistical sources only. Systematic uncertainties originating
    from the non-multi-jet subtraction are assumed to be negligible
    due to the small size of the subtraction in the 1 $b$-tag SS
    region.}%
  \label{fig:mjfakes_fake_factors}
\end{figure}


\subsubsection{Measurement of fake factors for events selected by
  single-\tauhadvis triggers}

The measurement of fake factors for events selected by
single-\tauhadvis triggers proceeds differently from the di-\tauhadvis
trigger case. Due to the selections applied at the HLT and the usually
large difference in \pT between both \tauhadvis candidates, the
single-\tauhadvis trigger fake factors are measured separately for the
leading and sub-leading \tauhadvis candidates. Additionally, the high
\pT thresholds on \tauhadvis at trigger-level provide large rejection
of most SM processes, limiting the number of events entering the
control regions for the fake factor measurement, thus preventing a
differential fake factor measurement in \tauhadvis \pT and $\eta$.

The approach of averaging the background estimates obtained from the
two partitions of the Anti-ID region remains valid for
single-\tauhadvis triggers, including~\Cref{eq:inclusive_fake_factor}
which can be used to calculate the fake factors. The main difference
between the the single- and di-\tauhadvis trigger fake factor
measurement is the replacement of the variables specifying the \pT and
$\eta$ bin in $\myvec{x}_\tau$ with an indicator variable specifying
whether the anti-\tauhadvis is leading or sub-leading in \pT.

% First, at the HLT \tauhadvis
% identification is only applied to one of the \tauhadvis candidates,
% preventing an inclusive treatment of both \tauhadvis
% candidates. Second, the high \pT thresholds on \tauhadvis at
% trigger-level has high rejection of most SM processes, limiting the
% number of events entering the control regions for the fake factor
% measurement. As a result, the fake factors for singe-\tauhadvis
% triggers cannot be measured differentially in \tauhadvis \pT and
% $\eta$.

The measured single-\tauhadvis trigger fake factors are shown
in~\Cref{fig:mjfakes_stt_ffs} for the three major data collection
periods. Each period is divided into four categories depending on
$N_{\text{tracks}}$ and whether the anti-\tauhadvis is leading
($\tau_0$) or sub-leading ($\tau_1$) in \pT.

\begin{figure}[htbp]
  \centering

  \includegraphics[width=0.495\textwidth]{fakefactors/fake_factors_stt}

  \caption{Single-\tauhadvis trigger fake factors measured in the 1
    $b$-tag SS region, separately for the three major data collection
    periods. The measurement is performed in bins of the reconstructed
    \tauhadvis decay mode (1- and 3-prong) and separately for cases
    where the anti-\tauhadvis is leading ($\tau_0$) and sub-leading in
    \pT ($\tau_1$).}%
  \label{fig:mjfakes_stt_ffs}
  % \todo[inline]{Largest deviation for leading 1-prong tau possibly
  % due to looser pT threshold. But why not for 3-prong?}
\end{figure}


\subsubsection{Validation of the multi-jet estimate in the 1 $b$-tag OS region}

An independent validation of the background estimate can be performed
in the 1 $b$-tag OS ID region (cf.\ \Cref{fig:fakefactor_regions}).
% , which is not part of the fake factor measurement.
After the event pre-selection, this region has a multi-jet purity of
about \SI{50}{\percent} with the dominant non-multi-jet contributions
originating from \Zjets and \ttbar. The multi-jet purity is enhanced
for validation purposes by requiring events to fulfil
% https://twiki.cern.ch/twiki/bin/view/AtlasProtected/MetSignificance
% Using `TreatPUJets == true' and Basic soft term (met::Random)
\begin{align*}
  \mMMC > \SI{110}{\GeV} \qquad \text{and} \qquad \mathcal{S} < 3 \,\text{,}
\end{align*}
where $\mathcal{S}$ is the object-based \pTmissAbs
significance~\cite{ATLAS-CONF-2018-038}. The \pTmissAbs significance
measures the statistical significance of a test comparing the
hypothesis that the reconstructed \pTmissAbs is compatible with zero
within the expected measurement errors, to the alternative hypothesis
of \pTmissAbs primarily originating from undetected weakly interacting
particles.

The distributions of the variables used to define the multi-jet
validation region are shown in~\Cref{fig:fake_factor_OSVR_cutvars}
after pre-selection. The contribution of \Zjets is reduced by
rejecting events with di-$\tauhad$ masses close to the \PZ boson mass.
Multi-jet events are expected to have little real \pTmissAbs, thus
events with a significant \pTmissAbs measurement are rejected to
reduce the \ttbar contribution in this region. The selection increases
the multi-jet purity in the validation region to \SI{75}{\percent}
with a multi-jet selection efficiency of about \SI{50}{\percent} with
respect to the pre-selection.

\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/mMMC_presel}
    \subcaption{}
  \end{subfigure}\hspace*{0.04\textwidth}%
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/metSig_presel}
    \subcaption{}
  \end{subfigure}

  \caption{The invariant di-\tauhad mass (a) and the object-based
    \pTmissAbs significance (b) in the 1 $b$-tag OS ID region after
    the pre-selection. The estimate of the multi-jet background (light
    blue) is obtained using the fake factor method (cf.\
    \Cref{fig:fakefactor_regions}). Fake-\tauhadvis originating from
    \ttbar (red) are estimated using simulation. The background
    prediction is shown pre-fit, including statistical and
    detector-related systematic uncertainties.}
  \label{fig:fake_factor_OSVR_cutvars}
\end{figure}

The multi-jet background prediction in the validation region is
obtained by applying the measured fake factors to events in the OS
Anti-ID region after subtracting non-multi-jet contributions. The
non-multi-jet backgrounds in the OS ID region are estimated using
simulation. The total background prediction in the multi-jet VR is
compared to data in~\Cref{fig:fake_factor_OSVR_kinematics} for several
observables of the leading and sub-leading \tauhadvis candidate.

\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/Tau0Pt_fakevr}
  \end{subfigure}\hspace*{0.04\textwidth}%
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/Tau1Pt_fakevr}
  \end{subfigure}

  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/Tau0Eta_fakevr}
  \end{subfigure}\hspace*{0.04\textwidth}%
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/Tau1Eta_fakevr}
  \end{subfigure}

  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/Tau0Ntrk_fakevr}
  \end{subfigure}\hspace*{0.04\textwidth}%
  \begin{subfigure}{0.45\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/fake_os_vr/Tau1Ntrk_fakevr}
  \end{subfigure}

  \caption{Validation of \tauhadvis observables in the multi-jet VR
    defined by the requirements: 1 $b$-tag OS,
    $\mMMC > \SI{110}{\GeV}$, and $\mathcal{S} < 3$. The multi-jet
    background prediction (blue) is obtained using the fake factor
    method. The \tauhadvis observables \pT (top), $\eta$ (centre), and
    $N_{\text{tracks}}$ (bottom) are shown for the leading (left) and
    sub-leading \tauhadvis (right). The background prediction is shown
    prior to the fit and includes statistical and detector-related
    systematic uncertainties.}%
  \label{fig:fake_factor_OSVR_kinematics}%
  % Explicitly say that there are no fake uncertainties here yet?
\end{figure}

Good agreement between the background prediction and data is observed
in the validation region for \tauhadvis-related observables. Further
tests of the assumptions of the fake factor method can be performed by
a comparison of the fake factors measured in the 1 $b$-tag SS region
with fake factors obtained from a measurement in the 1 $b$-tag OS
multi-jet VR. Under the assumptions of the fake factor method, both OS
and SS fake factors are expected to agree. Possible differences
between both sets of fake factors can originate from a violation of
the assumptions or from a mismodelling of the subtracted non-multi-jet
backgrounds.

Comparisons of fake factors measured in the OS and SS regions are
shown in~\Cref{fig:fake_factor_OSSS} for di-\tauhadvis and
single-\tauhadvis triggers. A comparison of the all sets di-\tauhadvis
trigger fake factors using $\chi^2$-tests is given
in~\Cref{tab:fake_factor_osss_chi2test} showing good agreement with
one exception. %
% All sets of fake factors are compared using $\chi^2$-tests,
% the results for di-\tauhadvis triggers are summarised
% in~\Cref{tab:fake_factor_osss_chi2test}, showing good agreement with
% one exception.
A relative deviation of about \SI{50}{\percent} between OS and SS fake
factor is observed for a single fake factor bin for di-\tauhadvis
triggers in 2015--2016.\footnote{The bin corresponds to 3-prong
  \tauhadvis with \pT from \SIrange{50}{65}{\GeV} in the end-cap of the
  detector. The OS fake factor for this bin is \num{0.09 +- 0.02} and
  the SS fake factor \num{0.21 +- 0.03}.} Except for this bin, no
large systematic differences between OS and SS fake factors are
observed, however the power of this test is limited by the
uncertainties of the fake factor measurement in the OS region. To
account for non-closure between the OS and SS fake factors, the full
difference between both sets of fake factors is assigned as an
additional systematic uncertainty and propagated to the multi-jet
estimate.


\begin{figure}[htbp]
  \centering

  \begin{subfigure}[t]{0.48\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/os_ss/fake_factors_osss_18}
    \subcaption{Comparison of OS and SS fake factors for events
      selected by di-\tauhadvis triggers. Only the 2018 data
      collection period is shown for illustration purposes.}
    \label{fig:fake_factor_OSSS_dtt}
  \end{subfigure}\hfill%
  \begin{subfigure}[t]{0.48\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/os_ss/fake_factors_osss_stt}
    \subcaption{Comparison of OS and SS fake factors for events
      selected by single-\tauhadvis triggers for all major data
      collection periods.}
    \label{fig:fake_factor_OSSS_stt}
  \end{subfigure}

  \caption{Relative deviation of fake factors measured in the 1
    $b$-tag OS multi-jet VR compared to the nominal set of fake
    factors measured in the 1 $b$-tag SS region (cf.\
    \Cref{fig:mjfakes_fake_factors,fig:mjfakes_stt_ffs}). The relative
    deviation is measured as $\FF_\text{OS} / \FF_\text{SS} - 1$ and
    is used to define a non-closure uncertainty that is propagated to
    the multi-jet background estimate when applying SS fake factors to
    events in OS regions. Statistical uncertainties from the finite
    number of observed data events and the non-multi-jet subtraction
    are shown.}
  \label{fig:fake_factor_OSSS}
\end{figure}


\begin{table}[htbp]
  \centering

  \caption{Comparison of OS and SS fake factors for di-\tauhadvis
    triggers using $\chi^2$-tests to summarise the statistical
    compatibility of both sets of fake factors over all \tauhadvis \pT
    bins. The barrel and end-cap detector regions correspond to
    \tauhadvis $|\eta| < 1.37$ and $|\eta| \geq 1.52$, respectively.}%
  \label{tab:fake_factor_osss_chi2test}

  \input{tables/mjfakes_osss_chisq.tex}
\end{table}


\subsubsection{Estimation of multi-jet backgrounds in the signal region}

The estimation of the multi-jet background in the \hadhad signal
region (2 $b$-tag OS ID) is obtained by applying fake factors from the
1 $b$-tag SS region to events in the 2 $b$-tag OS Anti-ID region after
subtraction of non-multi-jet processes. In addition, these fake
factors are multiplied by a 1 to 2 $b$-tag transfer factor to account
for possible differences between fake factors for 1 and 2 $b$-tag
regions (cf.\ \Cref{fig:fakefactor_regions}). The change in \btag
requirement is not expected to affect the measured fake factors, such
that the transfer factors mainly serve to provide an estimate of the
uncertainty on the extrapolation.

The transfer factors are determined by comparing fake factors measured
in the 2 $b$-tag SS region to ones extracted in the 1 $b$-tag SS
region. Due to the large multi-jet rejection of the 2 $b$-tag
requirement, the comparison is performed using fake factors measured
inclusively in the trigger category, \tauhadvis \pT and \tauhadvis
$\eta$ but separately for 1- and 3-prong \tauhadvis candidates, for
cases where the anti-\tauhadvis is leading and sub-leading in \pT, and
for the three major data-taking periods. The 1 to 2 $b$-tag transfer
factor is defined as the ratio
\begin{align*}
  \text{TF}_{1 \ra 2\,b\text{-tag}} = \frac{\FF_{\text{SS}}^{2\,b\text{-tag}}}{\FF_{\text{SS}}^{1\,b\text{-tag}}} \,\text{.}
\end{align*}

The measured transfer factors are shown
in~\Cref{fig:mjfakes_transfer_factor} showing no statistically
significant difference between fake factors derived in the 1 and 2
$b$-tag regions. The power of this comparison is limited by
uncertainties on the fake factor estimate in the 2 $b$-tag region thus
extrapolation uncertainties based on the uncertainties of the transfer
factor measurement will still be assigned.
% Extrapolation uncertainties are defined by varying the transfer
% factors within their uncertainty, separately for every transfer
% factor bin, propagating the effect to the multi-jet estimate in the
% 2 $b$-tag region.

\begin{figure}[htbp]
  \centering

  \includegraphics[width=0.495\textwidth]{fakefactors/transfer_factors}

  \caption{Transfer factors describing the extrapolation of fake
    factors measured in 1 $b$-tag regions to 2 $b$-tag regions. The
    transfer factors are shown separately for 1- and 3-prong
    \tauhadvis, for cases where the anti-\tauhadvis is leading
    ($\tau_0$) and sub-leading ($\tau_1$) in \pT, and for the three
    major data-taking periods.  The statistical uncertainties on the
    transfer factors are shown.}%
  \label{fig:mjfakes_transfer_factor}
\end{figure}

A disadvantage of applying the fake factor method in the 2 $b$-tag
region is the low multi-jet purity of about \SI{50}{\percent} in the 2
$b$-tag OS Anti-ID region (cf.\
\Cref{tab:mjfakes_yields}). Consequently, a large subtraction of
non-multi-jet processes has to be performed when applying fake factors
to obtain the multi-jet prediction in the signal region.  The size of
the subtraction in the 2 $b$-tag OS Anti-ID is illustrated
in~\Cref{fig:mjfakes_2tag_os_antiid}, showing that \ttbarFakes is the
dominant source of non-multi-jet events in this region. Due to the
large relative size of the subtracted non-multi-jet component, any
uncertainties affecting the subtracted components will have a large
impact on the multi-jet estimate in the ID region. This is the main
limitation of the multi-jet estimation method used in this analysis.

\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/region_plots/tau0pt_2tag_os_antiid}
    \subcaption{}
  \end{subfigure}
  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{fakefactors/region_plots/tau1pt_2tag_os_antiid}
    \subcaption{}
  \end{subfigure}

  \caption{Histogram of the leading (a) and sub-leading (b) \tauhadvis
    candidate \pT in the 2 $b$-tag OS Anti-ID region. Non-multi-jet
    backgrounds are display as coloured histograms and include the
    statistical uncertainty of the prediction. The difference between
    the observed data and the non-multi-jet background prediction is
    attributed to the missing multi-jet estimate.}%
  \label{fig:mjfakes_2tag_os_antiid}
\end{figure}


\subsubsection{Uncertainties on the multi-jet prediction in the
  \hadhad signal region}

% Uncertainty ranking:
% ttbarFake subtraction: ~7.4%
% Other subtraction: 5.9%
% Extrapol: ~5.5%
% ttbar subtraction: ~2.8%
% Statistical: 1.9 %
% FF statistical: 1.4%
% OS/SS non-closure: 1.0%
%
% Total: ~11.5%

The following systematic uncertainties are considered and propagated
to the multi-jet estimate in the \hadhad signal region:
\begin{itemize}

\item Statistical uncertainties on the fake factors.

\item Non-closure uncertainty between fake factors estimated in 1
  $b$-tag OS and SS regions.

\item Extrapolation uncertainties on fake factors measured in 1
  $b$-tag regions to 2 $b$-tag regions.

\item Non-multi-jet subtraction uncertainties from the subtraction of
  \ttbar, \ttbarFakes, and other processes in the 2 $b$-tag OS Anti-ID
  region.

\end{itemize}

% FF measurement statistical uncertainty (1.4%)
The effect of fake factor statistical uncertainties on the multi-jet
prediction in the signal region is estimated by performing
$\pm 1 \sigma$ variations of fake factors separately for all bins of
the measurement. The discriminants used in this analysis are
insensitive to variations of fake factors in a single bin and
therefore all variations are combined into a normalisation uncertainty
on the multi-jet estimate, reducing the number of free parameters in
the background model. The resulting uncertainty on the multi-jet
estimate in the signal region is $\pm \SI{1.4}{\percent}$.

% OS-SS uncertainty
The non-closure uncertainty from the comparison of fake factors
measured in the 1 $b$-tag SS and OS regions is estimated by assigning
the full difference between the central values of both measurements as
an uncertainty on the fake factors. The impact of this variation on
the shape of distributions in the signal region is considered in the
background model. The difference between OS and SS fake factors is
small, thus the non-closure uncertainty has only a minor impact on the
normalisation of the multi-jet estimate of $\pm \SI{1.0}{\percent}$.

% Extrapolation uncertainty (varying coherently for all four
% categories)
The uncertainty on the extrapolation of fake factors from the 1
$b$-tag to 2 $b$-tag regions is estimated by performing variations of
the measured transfer factors within their statistical
uncertainty. The variations are performed separately for the four
categories of the transfer factor measurement. As a conservative
estimate of the uncertainty, transfer factors of the three data
collection periods are varied coherently in a given
category. Consequently, the multi-jet background model receives four
degrees of freedom from extrapolation uncertainties and any shape
effect of these variations is propagated to the distributions of
interest. The combined uncertainty of these variations on the
multi-jet normalisation in the signal region is
$\pm \SI{5.5}{\percent}$.

% Subtraction uncertainty
%   ttbar (+16.8% -18.6%)
%   ttbar fakes
%   other (50% up and down)
Systematic uncertainties from the subtraction of non-multi-jet events
in the 2 $b$-tag OS Anti-ID region are estimated by performing
variations of the subtracted contributions from \ttbarTrue,
\ttbarFakes, and other non-multi-jet processes. In all cases, the
effect of these variations on the shape of the multi-jet prediction in
the signal region is considered in the background model.

The uncertainty resulting from the subtraction of \ttbarTrue,
constituting about \SI{13}{\percent} of the total subtraction, is
obtained by varying the normalisation of the subtracted \ttbarTrue
template by its uncertainty. This uncertainty is determined by
performing variations of the modelling of \ttbar in simulation
according to the approach previously used for the \ttbarFakes scale
factor measurement in~\Cref{sec:bkg_hadhad_ttbarfakes} and described
in Ref.~\cite{ATL-PHYS-PUB-2020-023}. The following summarises the
variations and their impact on the normalisation of the \ttbarTrue
template in the 2 $b$-tag OS Anti-ID region:
\begin{itemize}
\item Hard scatter and PS+NLO matching: $\pm\SI{6.0}{\percent}$.
\item Parton shower and hadronisation model: $\pm\SI{11}{\percent}$.
\item Renormalisation and factorisation scale:
  $\numpmerr{+9.9}{-9.4}\valuesep{\si{\percent}}$ and
  $\numpmerr{+2.8}{-2.2}\valuesep{\si{\percent}}$.

\item Initial-state and final-state radiation:
  $\numpmerr{+0.53}{-0.68}\valuesep{\si{\percent}}$ and
  $\numpmerr{+5.4}{-10.0}\valuesep{\si{\percent}}$.
\end{itemize}
The combination of these sources yields a normalisation uncertainty on
the \ttbarTrue template of
$\numpmerr{+16.8}{-18.6}\valuesep{\si{\percent}}$. The resulting
uncertainty on the multi-jet prediction in the signal region is
$\pm \SI{2.8}{\percent}$, which is small due to the small relative
size of the \ttbarTrue subtraction.

The subtraction of \ttbarFakes in the 2 $b$-tag OS Anti-ID region
accounts for \SI{78}{\percent} of the total non-multi-jet subtraction
in this region. Five variations of the subtraction are performed which
are defined using results of the scale factor measurement for
\ttbarFakes in the Anti-ID region (cf.\
\Cref{sec:bkg_hadhad_ttbarfakes}). %Four variations are provided by the
% uncertainties of the Anti-ID scale factor measurement.
For every combination of \tauid applied at trigger-level and offline
\tauhadvis reconstruction, the (eigen-)variations explaining most of
the variance of the scale factor measurement are used to define the
\ttbarFakes subtraction uncertainty, yielding a total of four
variations. The variations sub-leading in the explained variance have
negligible impact on the multi-jet prediction and are therefore
omitted to reduce the number of free parameters in the fit model. An
additional uncertainty is assigned according to the difference between
the \ttbarFakes prediction with and without the scale factor
correction to account for the reduced set of experimental systematic
uncertainties used for the measurement of \ttbarFakes scale factors in
the Anti-ID region. These five variations have a combined effect on
the normalisation of the multi-jet prediction in the signal region of
$\pm\SI{7.4}{\percent}$, representing the largest source of uncertainty on
the multi-jet estimate.

Other non-multi-jet processes account for approximately
\SI{9}{\percent} of the non-multi-jet subtraction in the 2 $b$-tag OS
Anti-ID region. The dominant contributions are events from \Vjets and
single top production, both processes contributing similarly to the
subtraction. As a conservative estimate, the normalisation of the
subtracted components is varied by $\pm \SI{50}{\percent}$,
propagating the effect of these variations to the multi-jet prediction
in the signal region. This variation changes the normalisation of the
multi-jet estimate in the signal region by $\pm\SI{5.9}{\percent}$.

In addition to these systematic uncertainties, statistical
uncertainties originating from the finite number of events in the 2
$b$-tag OS Anti-ID region and the statistical precision of the
simulation-based subtraction of non-multi-jet processes are
considered. This uncertainty is implemented in the fit model using the
method by Barlow and Beeston~\cite{barlow1993,conway2011} separately
for every bin of the fitted observable. The effect of this uncertainty
on the multi-jet normalisation in the signal region is
$\pm \SI{1.9}{\percent}$.

A summary of all uncertainties affecting the multi-jet background
prediction in the signal region is given
in~\Cref{tab:multi_jet_uncertainties}. The dominant sources of
uncertainty on the multi-jet normalisation are the subtraction of
\ttbarFakes, the subtraction of other non-multi-jet processes~(\Vjets
and single top), and the extrapolation of 1 $b$-tag fake factors to 2
$b$-tag regions.

\begin{table}[htbp]
  \centering

  \caption{Impact of uncertainties on the normalisation of the
    multi-jet prediction in the \hadhad signal region. The effect of
    uncertainties on the shape of the multi-jet prediction are
    propagated except for the fake factor statistical uncertainty
    (\texttt{FF\_STAT\_HADHADSR}) which is an uncertainty on the
    normalisation only. Uncertainties are grouped by their source and
    given separately for each nuisance parameter. $\dagger$:
    statistical uncertainties from the finite number of simulated and
    control region events are combined for all background processes
    thus no dedicated nuisance parameters exist for the statistical
    uncertainty of the multi-jet prediction.}%
  \label{tab:multi_jet_uncertainties}

  \input{tables/multi_jet_uncertainties}
\end{table}

% Yield table / plots of regions

% \todo[inline]{Could we use nOS to enhance statistics? Maybe flip the FF method
%   so that we use events in SS ID to build the template instead of OS Anti-ID.}

% \todo[inline]{Can we make the STT FF depend on the trigger-match instead of
%   the leading / subleading binning?}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../phd_thesis"
%%% End:
