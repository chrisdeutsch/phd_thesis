\section{Systematic Uncertainties}
\label{sec:uncertainties}

\subsection{Experimental Uncertainties}

\todo[inline]{Make this a 'description'?}

The uncertainty on the integrated luminosity of the $pp$ collision
dataset collected with the ATLAS detector in the period from 2015 to
2018 is \SI{1.7}{\percent}~\cite{ATLAS-CONF-2019-021}. This
uncertainty is applied to all processes estimated using simulation
that are normalised using theory cross sections.

An uncertainty on the reweighting of the instantaneous luminosity
distribution used for the pile-up overlay in simulated data to match
the conditions observed in data is considered.

Uncertainties on electrons in simulation are obtained from dedicated
calibration measurements~\cite{EGAM-2018-01,TRIG-2018-05} updated for
the \SI{139}{\per\femto\barn} Run~2 dataset. The electron energy scale
and resolution is measured in $Z \to e^+e^-$ events and propagated to
predictions by shifting and smearing momenta of electrons in
simulation. Uncertainties on the calibration of electron
reconstruction, identification, isolation, and trigger efficiencies in
simulation are obtained from measurements in~$J/\psi \to e^+e^-$ and
$Z \to e^+e^-$ events and applied as alternative weights to electrons
in simulation.

Muons... \cite{MUON-2018-03} \\
Scale, (Sagitta) , (ID? MS?) \\
Efficiencies: Reconstruction, Isolation, Trigger

Taus... \\
Scale \\
Efficiencies: Reconstruction, Identification, eVeto (taus and
electrons reconstructed as taus), Trigger

Jets... (JVT, JES, JER) -- JES/JER \cite{JETM-2018-05}

MET

Flavour tagging... \cite{FTAG-2018-01}

\begin{table}[htbp]
  \centering

  \input{tables/uncertainties_experimental}

  \caption{Table of CP uncertainties}
  \label{tab:bla}
\end{table}

\todo[inline]{Where applicable, dedicated calibrations for ATLAS fast
  simulation are used.}


\subsubsection{Experimental?}


\todo[inline]{Split in experimental \& theory uncertainties}

\todo[inline]{Experimental: Jets -- JES, JER, JVT, b-tag}

\todo[inline]{Experimental: TAUS -- TES, Reco, ID}

\todo[inline]{Experimental: electrons / muons -- ?}

\todo[inline]{Experimental: MET -- all momentum / energy uncertainties are
  propagated to MET, additionally uncertainties related to the soft term}


\subsection{Theory uncertainties}%
\label{sec:modelling_uncertainties}%
\label{sec:theory_uncertainties}

\todo[inline]{Write Intro: Introduce what is meant with ``acceptance'', i.e.\ \AccTimesEff.}


\subsubsection{Uncertainties on the relative acceptance of \ZHF and
  \ttbar between regions}

The normalisation of the \ZHF and \ttbar backgrounds are measured in
the combined likelihood fit of control and signal regions. Constraints
on the normalisation of the \ZHF background primarily originate from
the dedicated control region. The \ttbar background normalisation is
mainly constrained in the signal region of the \lephad SLT channel and
the \ZHF control region. Due to the determination of the normalisation
of these processes from the fit to data, any uncertainties on their
overall normalisation, for example uncertainties on the total cross
sections, are omitted. Uncertainties changing the relative acceptance
of \ZHF or \ttbar events between regions have to be considered
instead. These uncertainties will be referred to as \emph{relative
  acceptance uncertainties}, hereafter. The approach outlined in the
following was originally adopted by the previously published analysis
in this channel~\cite{HIGG-2016-16-witherratum} from searches and
measurements of $VH$~($H\to\bbbar$)
production~\cite{HIGG-2016-29,HIGG-2018-04,HIGG-2018-51}.

Assuming a general case of a background process that is estimated
using simulation and normalised by a fit to data in two analysis
regions A and B, with region A being defined as the reference
region. In this case, the probability of an event to be selected in a
given region~R is given by the product of acceptance and efficiency,
$(\AccTimesEff)_{\text{R}}$, for this region. The simulation predicts
how \AccTimesEff relates between both regions and one can define the
ratio
\begin{align*}
  \mathcal{R} = \frac{(\AccTimesEff)_{\text{B}}}{(\AccTimesEff)_{\text{A}}} \,\text{,}
\end{align*}
which will be be referred to as the \emph{relative acceptance} between
regions A and B. Uncertainties on the modelling of $\mathcal{R}$ in
simulation are assigned as uncertainties on the normalisation of the
background process in region B\todo{Show mathematically?} (no
additional uncertainties are assigned in the reference region).They
are estimated by performing variations of the background prediction,
for example using alternative generator configurations, and estimating
a relative change of~$\mathcal{R}$ according to
\begin{align}
  \frac{\Delta \mathcal{R}}{\mathcal{R}} = \frac{\mathcal{R}(\text{variation}) - \mathcal{R}(\text{nominal})}{\mathcal{R}(\text{nominal})} \,\text{.}
  \label{eq:relative_acceptance_uncertainty}
\end{align}
The relative acceptance is used to define the uncertainties due to the
cancellation of the effect of variations leading to the same relative
change in \AccTimesEff in both regions, which corresponds to an
overall change in normalisation and can be absorbed in the
normalisation factor of the process.

% This uncertainty on the relative acceptance between the the
% reference region A and region B is included in the background model
% by assigning a normalisation uncertainty of
% $\Delta \mathcal{R} / \mathcal{R}$ on the background in region B.

% The absolute value\footnote{When introducing multiple regions, the
% relative sign of $\Delta \mathcal{R} / \mathcal{R}$ when comparing
% different regions to the same reference is important when
% correlating these uncertainties in the statistical analysis and is
% kept to allow to consistently define the variations.} of
% $\Delta \mathcal{R} / \mathcal{R}$ is considered the extrapolation
% uncertainty.

% The shape effects of uncertainties are estimated separately and will be described in~\Cref{sec:modelling_uncertainties}.

% Note: Sign is important -> direction of effect when correlating systematics

The relative acceptance uncertainties are defined using the \ZHF
control region as a reference, which provides good constraints on both
the \ZHF and \ttbar backgrounds. The uncertainties are estimated
separately for the \ZHF and \ttbar backgrounds in all three signal
regions (\hadhad, \lephad SLT, \lephad LTT). Uncertainties originating
from the same source are assumed to be fully correlated between all
analysis regions.

The relative acceptance uncertainties originating from the modelling
of the \ZHF background in simulation are estimated by performing
variations of the event generation process. A brief description of the
variations is given in the following, reproducing the prescriptions
developed by the ATLAS collaboration:
\begin{description}

\item[Factorisation and renormalisation scales] Six variations of the
  factorisation and renormalisation scales are performed using
  internal reweighting implemented in
  \SHERPA[2.2.1]~\cite{Bothmann:2019yzt}, altering the scales by
  factors of $\frac{1}{2}$ and $2$. The following variations are
  considered:
  \begin{align*}
    \left( \frac{\muF}{\muF^{\text{nom.}}}, \frac{\muR}{\muR^{\text{nom.}}} \right) \in
    \left\{ (\tfrac{1}{2}, \tfrac{1}{2}), (\tfrac{1}{2}, 1), (1, \tfrac{1}{2}), (1, 2), (2, 1), (2, 2) \right\} \,\text{,}
  \end{align*}
  where $\muF^{\text{nom.}}$ and $\muR^{\text{nom.}}$ are the nominal
  values of the scales.

\item[Resummation scale] The scale of the resummation of soft gluon
  emissions in the \SHERPA parton shower is varied by factors
  $\frac{1}{2}$ and 2. Variations of the resummation scale are
  provided in parametrised form with respect to the default \SHERPA
  configuration in~\cite{anders:2017}.

\item[Multi-jet merging scale] The simulation of \Zjets events with
  \SHERPA[2.2.1] uses matrix elements of NLO accuracy for up to two
  and LO for up to four partons. The multi-parton matrix elements are
  merged with the parton shower using an extension of the CKKW
  algorithm~\cite{Catani:2001cc,Hoeche:2009rj,Hoeche:2012yf}. The
  characteristic scale~$Q_{\text{cut}}$ of the multi-jet merging
  algorithm is varied from its nominal value of
  $Q_{\text{cut}} = \SI{20}{\GeV}$ to \SI{15}{\GeV} and
  \SI{30}{\GeV}~\cite{anders:2017}. These variations are provided,
  following the approach for the resummation scale, in parametrised
  form in~\cite{anders:2017}.
  %\cite{ATLAS:2021yza}

\item[PDF+\alphas] Uncertainties on the \NNPDF[3.0nnlo] set of
  PDFs~\cite{Ball:2014uwa} are evaluated using 100 replica sets
  provided through the \textsc{LHAPDF6} library~\cite{Buckley:2014ana}
  and implemented using internal reweighting in \SHERPA. The
  uncertainty on \alphas propagated by comparing \NNPDF[3.0nnlo] PDF
  sets with $\alphas(\mZ^2) = 0.117$ and $0.119$ with the nominal set
  using a value of $0.118$. Finally, an uncertainty on the choice of
  PDF set is estimated by comparing with two alternative PDF sets
  \MMHT[nnlo68cl]~\cite{Harland-Lang:2014zoa} and
  \CT[14nnlo]~\cite{Dulat:2015mca}.

\item[Alternative generator and parton shower] The prediction of
  \Zjets with the default configuration of \SHERPA[2.2.1] is compared
  to an alternative setup using~\MGNLO[2.2.2]~\cite{Alwall:2014hca}
  for the calculation of the hard interaction at LO interfaced
  to~\PYTHIA[8.186]~\cite{Sjostrand:2007gs} for parton showering.

\end{description}
These variations are used to estimate uncertainties on the relative
acceptance for the \ZHF background in all
three signal regions according
to~\Cref{eq:relative_acceptance_uncertainty}. The relative acceptance
uncertainties in the signal regions are summarised
in~\Cref{tab:uncertainties_zhf_extrapol}.

\begin{table}[htbp]
  \centering

  \input{tables/uncertainties_zhf_extrapol}

  \caption{Relative acceptance uncertainties on the \ZHF background
    ($Z+bb$, $Z+bc$, $Z+cc$) in all three signal regions. The relative
    sign of the effect of variations between the signal regions is
    indicated by the ``$\pm$'' and ``$\mp$'' prefixes. The total
    uncertainty is given for illustration of the size of the
    uncertainties only.}
  \label{tab:uncertainties_zhf_extrapol}
  \todo[inline]{Use S column type}
\end{table}

The \lephad SLT signal region selection is the closest to the \ZHF
control region, resulting in a small relative acceptance uncertainty
of approximately \SI{9}{\percent}. The \hadhad and \lephad LTT
channels deviate yielding an uncertainty of approximately
\SI{16}{\percent}. In all cases the dominant sources of uncertainty
are the scale variations as well as the comparison with
\MGNLO+\PYTHIA[8]\todo{This needs some work}.

The relative acceptance uncertainties are similarly estimated for the
floating \ttbar background in all three signal regions. The
prescriptions documented in~\cite{ATL-PHYS-PUB-2020-023} are used to
estimate modelling uncertainties for the nominal configuration of the
\ttbar simulation using \POWHEGBOX[v2]+\PYTHIA[8]. A revised version
of these prescriptions were previously presented
in~\Cref{sec:bkg_hadhad_ttbarfakes} as part of the \ttbarFakes scale
factor measurement. In the following, a brief description highlighting
the differences is given.

The uncertainty of the modelling of the hard interaction (parton
shower) is evaluated by replacing \POWHEGBOX[v2] (\PYTHIA[8]) with
\MGNLO (\HERWIG[7]) for the matrix element (parton shower)
generation. Explicit variations of the factorisation scale,
renormalisation scale, and \PYTHIA[8] damping parameter, $\hdamp$, are
omitted. They are included in the variation of initial-state radiation
instead. The uncertainty on the final-state radiation is estimated
using interal reweighting in \PYTHIA[8] to change the scale used for
FSR branchings. Similarly, uncertainties on the PDF set and the value
of \alphas is estimated using internal reweighting.

The relative acceptance uncertainty for \ttbar backgrounds in the
three signal regions (relative to the \ZHF control region) is given
in~\Cref{tab:uncertainties_ttbar_extrapol}.

\begin{table}[htbp]
  \centering

  \input{tables/uncertainties_ttbar_extrapol}

  \caption{Relative acceptance uncertainties on the \ttbar background
    in all three signal regions. The relative sign of the effect of
    variations between the signal regions is indicated by the
    ``$\pm$'' and ``$\mp$'' prefixes. The total uncertainty is given
    for illustration of the size of the uncertainties only.}
  \label{tab:uncertainties_ttbar_extrapol}
\end{table}



\subsubsection{Signal modelling uncertainties: SM $HH$}

% CROSS SECTION
Uncertainties on the cross section of the SM $HH$ production in the
ggF and VBF production modes are considered when the signal strength,
$\mu = \sigma / \sigma_{\text{SM}}$, is used as a parameter of
interest and not the cross section. The uncertainty on the total cross
section of SM $HH$ in the ggF production mode~(NNLO
\FTapprox~CITATION) from the uncertainty on the PDF and \alphas is
\SI{\pm 3.0}{\percent}~\cite{LHCHWGHH} and from the scales and the
virtual top mass scheme~$^{+6\%}_{-23\%}$~\cite{Baglio:2020wgt}. For
the VBF production mode which is normalised using cross section at
N$^3$LO, the scale uncertainties
are~$^{+0.03\%}_{-0.04\%}$~\cite{LHCHWGHH} and the uncertainty from
PDF and \alphas is~\SI{\pm 2.1}{\percent}~\cite{LHCHWGHH}.
% Scale and scheme of the virtual top mass (\mtop scheme uncertainty)

Uncertainties on the signal acceptances are derived in all signal
regions by performing variations of the signal generation process. The
variations are ensured to leave the predicted total cross section
invariant to prevent double-counting of cross section
uncertainties. An uncertainty on the choice of the parton shower
program is estimated by comparing the nominal signal generation using
\PYTHIA[8.244] for parton showering with an alternative using
\HERWIG[7.1.6]. An uncertainty from the effect of missing higher
orders in the pertubative expansion is estimated by performing six
variations of the factorisation and renormalisation scales using
internal reweighting. Uncertainties on the PDF sets are estimated
using the prescriptions for the
\PDFforLHC[15nlo]~\cite{Butterworth:2015oua} and
\NNPDF[3.0nlo]~\cite{Ball:2014uwa} PDF sets for ggF and VBF,
respecively. The PDF uncertainties are provided in the form of 30
eigenvariations for \PDFforLHC[15nlo] and 100 replica sets for
\NNPDF[3.0nlo]. Finally, the value of $\alphas(\mZ^2)$ is varied up
and down by 0.0015 (0.001) about the central value of $0.118$ in the
\PDFforLHC[15nlo] (\NNPDF[3.0nlo]) PDF set.

% The \PDF4LHC[15nlo] prescription uses 30
% eigenvariations of the PDF set that are independently propagated to
% the observables and the deviations from the nominal value are added in
% quadrature to yield the uncertainty. For \NNPDF[3.0nlo] PDF set which
% provides uncertainties in the form of MC replicas, the uncertainty is
% defined by the sample standard deviation of the observable determined
% using 100 replicas of the PDF set.

The acceptance uncertainties on the SM $HH$ signal are summarised
in~\Cref{tab:theory_uncertainty_signal} for the considered production
modes. The uncertainties on PDF+\alphas are found to be negligible in
most cases and thus omitted. The impact of the variations on the shape
of the MVA discriminants is found to be negligible in most cases. The
variations of the factorisation and renormalisation scales for the VBF
production mode in the \hadhad signal region is found to induce small
changes in the shape (up to \SI{2}{\percent} in bins sensitive to the
SM $HH$ signal) of the SM $HH$ BDT score distribution which is
implemented as a shape uncertainty for later statistical evaluation.

\begin{table}[htbp]
  \centering

  \input{tables/theory_uncertainty_signal}

  \caption{Theory uncertainties on the acceptance of non-resonant SM
    $HH$ signals in the three signal regions. Uncertainties marked as
    ``--'' are negligible.}
  \label{tab:theory_uncertainty_signal}
\end{table}


\subsubsection{Signal modelling uncertainties: BSM $X \to HH$}

Uncertainties on the acceptance of BSM \HH production via scalar
resonances are estimated for the choice of parton shower program,
factorisation and renormalisation scales, and PDF+\alphas. The
uncertainties are calculated for a subset of all mass points
considered in the statistical analysis and subsequently extrapolated
to the full set.

The acceptance uncertainty from the choice of parton shower program is
estimated by replacing the default setup using \HERWIG[7.1.3] with
\PYTHIA[8.235] for signals with six different masses:
\begin{align*}
  \mX / \si{\GeV} \in \left\{ 251, 260, 280, 400, 500, 1000
\right\} \,\text{.}
\end{align*}
The uncertainty is estimated by comparing the acceptance of
signal-like events, which for this purpose are defined as events
exceeding the 15-th percentile of the PNN score distribution for the
default event generation setup, between both parton shower
programs. This approach is taken due to large changes in acceptance of
(background-like) signal events at low PNN score to which this search
is not sensitive, thus avoiding an inflation of the parton shower
uncertainty at high PNN score. The uncertainties evaluated at six
points of \mX are linearly interpolated
($\SI{251}{\GeV} < \mX < \SI{1000}{\GeV}$) and extrapolated
($\mX > \SI{1000}{\GeV}$) to estimate uncertainties for signal masses
for which no alternative samples were produced.\todo{Table? Figure?}

Uncertainties from factorisation and renormalisation scales, as well
as from PDF+\alphas are evaluated using a generator-level analysis for
two mass points with $\mX = \SI{500}{\GeV}$ and \SI{1000}{\GeV}.



An additional uncertainty is assigned in the \hadhad and \lephad LTT
channels due to the lack of calibrations of \tauhadvis trigger
efficiencies when using ATLAS fast calorimeter simulation~CITATION.


due to the use of fast calorimeter simulation~CITATION

An additional uncertainty is assigned on the modelling of \tauhadvis
triggers



Fast simulation (up to 1 TeV): hadhad and LTT




Scale uncertainties: Negligible

PDF+alphas: negligible


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../phd_thesis"
%%% End:
