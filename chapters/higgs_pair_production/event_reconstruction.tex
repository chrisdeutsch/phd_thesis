\section{Object reconstruction and selection}
\label{sec:object_reconstruction}

The reconstruction and selection of physics objects (i.e.\ electrons,
muons, \tauhadvis, jets, $b$-tagged jets, missing transverse momentum)
proceeds by exploiting their signatures in the detector. The same
algorithms are used to reconstruct and identify these objects in
simulation and data recorded with the ATLAS detector. Differences
between the performance of object reconstruction and selection in
simulation and the observed data are accounted for by dedicated
calibration measurements of efficiencies, energy \& momentum scales
and resolutions. Uncertainties on these measurements are propagated to
the final results by performing variations of these properties in
simulation.

The following introduces the reconstruction and selection of physics
objects relevant to this analysis. A discussion of objects not
directly used in this analysis is omitted.


\subsection{Track reconstruction and primary vertex selection}

The trajectories of charged particles...

Charged particle tracks are reconstructed from their signature in the
inner tracking detectors of the ATLAS detector. They are a fundamental
input to other reconstruction and identification algorithms where they
are used at different levels of reconstruction quality.

Say a thing about track fitting?

The baseline selection for charged particle tracks requires
$\pT > \SI{400}{\MeV}$??? 500?  and $|\eta| < \num{2.5}$ in addition
to several requirements on the number of hits, the number of missing
hits (holes), and the number of hits shared between multiple tracks in
the silicon-based tracking detectors.

And impact parameter requirements.

The vertex with the largest $\sum \pT^2$ of associated tracks is
chosen as the primary vertex.

\cite{PERF-2015-08}


\subsection{Electrons}

Use likelihood-based electron identification algorithm with loose
working point.

\cite{EGAM-2018-01}



\todo[inline]{electrons: reco \& ID / isolation}


\subsection{Muons}

\todo[inline]{muons: reco \& ID / isolation}


\subsection{\tauhadvis}

\todo[inline]{taus: seeding; energy scale (LC \& BRT); track selection;
  acceptance; Tau-ID (jet \& e)}

\subsection{Anti-\tauhadvis}


\subsection{Jets}
\todo[inline]{Jet building from clusters; calibration; bad jet veto; JVT;
  b-tagging}

\todo[inline]{Particle flow}


\subsection{Missing Transverse Momentum}

The missing transverse momentum is denoted as \pTmiss with its
magnitude being \MET by convention.

\todo[inline]{\MET: negative vector sum of reconstructed objects; soft term}

\subsection{Short Object Selection}


\begin{description}

\item[Electrons] are required to have $\pT > \SI{7}{\GeV}$ and to be
  reconstructed within the acceptance of the tracking detectors
  $|\eta| < \num{2.47}$. Electrons in the transition region between
  the barrel and endcaps of the ATLAS detectors,
  $1.37 < |\eta| < 1.52$, are rejected. A likelihood-based
  discriminant is used for electron identification to reject electron
  candidates originating from jets and non-prompt electrons (e.g.\
  from photon conversions or decays of hadrons) by exploiting
  variables sensitive to the shower-shape, track quality, information
  about transition radiation emission in the TRT, and spatial and
  momentum matching between track and calorimeter
  cluster~\cite{EGAM-2018-01}. The loose electron identification
  working point is used corresponding to an average identification
  efficiency of about \SI{93}{\percent}~\cite{EGAM-2018-01}.

  % FCLoose
  % topoetcone20/pT < 0.2
  % ptvarcone20_TightTTVA_pt1000/pT < 0.15
  Electron candidates with high activity in the vicinity of the
  electron are rejected by making a loose requirement on both
  calorimeter- and track-based isolation variables
  ($E_{\text{T}}^\text{cone20} / \pT < 0.2$ and
  $p_{\text{T}}^{\text{varcone20}}/ \pT < 0.15$ as described in
  Ref.~\cite{EGAM-2018-01}). The electron selection efficiency of the
  isolation requirement exceeds \SI{95}{\percent} for electrons with
  $\pT > \SI{20}{\GeV}$, quickly approaching close to
  \SI{100}{\percent} efficiency at larger transverse momenta. This
  requirement is inverted as part of the \faketauhadvis background
  estimation in the \lephad channel to provide a control region
  enhanced in multi-jet events.

  % Post-selection:
  % Medium LH
  % pT > 18 GeV

\item[Muons] %are required to have $\pT > \SI{7}{\GeV}$
  % isPflowLoose_VarRadIso

\item[\tauhadvis]
\item[Anti-\tauhadvis]
\item[Jets]
\item[Missing transverse momentum]
\end{description}


\subsection{Overlap Removal}

% https://gitlab.cern.ch/atlas/athena/tree/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/
% Harmonization note: https://cds.cern.ch/record/1743654/files/ATL-COM-PHYS-2014-451.pdf

After the event is reconstructed a overlap-removal procedure is applied to
resolve ambiguities when a physical object is reconstructed as multiple
particles in the ATLAS detector. The angular distance $\dRy =
\sqrt{\Delta y^2 + \Delta \phi^2}$ is used to measure the overlap of two
reconstructed objects. \todo{Why rapidity instead of pseudorapidity?}

The following step-by-step procedure is used to resolve ambiguities in
the reconstructed objects:\todo{This would be nicer as a table}
\begin{itemize}
  % https://indico.cern.ch/event/807799/contributions/3362328/attachments/1818680/2973610/Presentation.pdf
  % https://indico.cern.ch/event/814156/contributions/3396841/attachments/1830226/2997072/Presentation.pdf
%\item jet - $\mu$: Reject jet if not \btagged, $N_\text{tracks} < 4$ and $\dRy
%  < 0.4$

% https://gitlab.cern.ch/atlas/athena/-/blob/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/Root/EleEleOverlapTool.cxx
\item $e_1$ - $e_2$: Reject $e_1$ if both electrons share the track and ${\pT}_1
  < {\pT}_2$

% https://gitlab.cern.ch/atlas/athena/-/blob/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/Root/TauLooseEleOverlapTool.cxx
\item \tauhadvis - $e$: Reject \tauhadvis if $\dRy < 0.2$ and $e$ passes \verb|DFCommonElectronsLHLoose|

% https://gitlab.cern.ch/atlas/athena/-/blob/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/Root/TauLooseMuOverlapTool.cxx
\item \tauhadvis - $\mu$: Reject \tauhadvis if $\dRy < 0.2$:\\
  Case 1 ($\tauhadvis \pT > \SI{50}{\GeV}$): $p_{\text{T}, \mu} > \SI{2}{\GeV}$
  and combined muon\\
  Case 2 ($\tauhadvis \pT \leq \SI{50}{\GeV}$): $p_{\text{T}, \mu} > \SI{2}{\GeV}$

% https://gitlab.cern.ch/atlas/athena/-/blob/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/Root/EleMuSharedTrkOverlapTool.cxx
\item $\mu$ - $e$: Reject $\mu$ if calo-muon and shared ID track
\item $e$ - $\mu$: Reject $e$ if shared ID track

% https://gitlab.cern.ch/atlas/athena/-/blob/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/Root/EleJetOverlapTool.cxx
\item jet - $e$: Reject jet if $\dRy < 0.2$, not \btagged or \btagged and
  ${\pT}_{e} > \SI{100}{\GeV}$
\item $e$ - jet: Reject $e$ if $\dRy < 0.4$

% https://gitlab.cern.ch/atlas/athena/-/blob/21.2/PhysicsAnalysis/AnalysisCommon/AssociationUtils/Root/MuJetOverlapTool.cxx
\item jet - $\mu$: Reject jet if not \btagged, $N_\text{track} < 3$ ($p_\text{T,
  track} > \SI{500}{\MeV}$), and $\dRy < 0.2$
\item $\mu$ - jet: Reject $\mu$ if $\dRy < 0.4$
\end{itemize}
Due to a bug in the PFlow jet reconstruction, an additional OLR step removing
prompt muons being reconstructed as fake jets is implemented in the official ASG
OLR tool.

\begin{table}[htbp]
  \centering

  \resizebox{\textwidth}{!}{%
    \input{tables/overlap_removal}
  }

  \caption{Overlap removal algorithm. In all cases $\dRy$ refers to
    the angular distance of }
\end{table}

Additionally, an analysis-specific overlap-removal procedure for \tauhadvis,
anti-\tauhadvis and jets is implemented:
\begin{itemize}
\item jet - \tauhadvis: Reject jet if $\dRy < 0.2$
\item anti-\tauhadvis - jet: Reject anti-\tauhad if jet is \btagged and $\dRy <
  0.2$
\item jet - anti-\tauhadvis: Reject jet  if $\dRy < 0.2$
\end{itemize}
This establishes the following priority: \tauhadvis > \btagged jet >
anti-\tauhadvis > un-tagged jet.

The priority, \btagged jet > \tauhadvis > anti-\tauhadvis > un-tagged jet, was
investigated as an alternative but found to reduce signal acceptance in the
2-tag region significantly due to limited \tauhad rejection of the DL1r \btag
algorithm at the \SI{77}{\percent} working point. With the alternative priority
the signal acceptance is reduced by about \SI{8}{\percent} (\SI{13}{\percent})
in $\tauhad\taulep$ ($\tauhad\tauhad$).

\todo[inline]{Is the above still up to date for PflowJets?}

\todo[inline]{Special treatment of lepton OLR for b-jet corrections}

\todo[inline]{Truth labelling of jets in simulation cf.\ VHbb evidence paper}

\todo[inline]{Truth labelling of fake taus in simulation}



\subsection{$b$-jet momentum corrections}
\label{sec:bjet_momentum_corrections}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../phd_thesis"
%%% End:
