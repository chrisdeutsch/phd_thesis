The main goal of the \tauhadvis reconstruction employed at the ATLAS
experiment is to reconstruct \tauhadvis candidates that originate from
hadronic decays of \tauleptons (\truetauhadvis) with high
efficiency. Therefore, objects from sources other than \tauhad are
frequently reconstructed as \tauhadvis candidates
(\faketauhadvis). Tau identification aims to distinguish between
\tauhadvis candidates from \tauhad and other sources.

The primary source of \faketauhadvis are quark- or gluon-initiated
jets due to the purely hadronic and jet-like signature of \tauhadvis
at the ATLAS experiment. Electrons can be another, less abundant,
source of \faketauhadvis which have to be distinguished from
\truetauhadvis using a dedicated algorithm. In the following, the
former classification task is referred to as \tauid while the latter
is referred to as \emph{electron veto}. Consequently, this chapter is
concerned with classifying the origin of \tauhadvis candidates as
either originating from \tauhad or from quark- or gluon-initiated
jets.

A number of features can be exploited to distinguish between
\tauhadvis candidates originating from \tauhad and quark- or
gluon-initiated jets:
\begin{description}

\item[\taulepton mass] The \taulepton has a mass of
  \SI{1.777}{\GeV}~\cite{pdg2020} and is therefore sufficiently
  massive to decay hadronically while still having a small mass
  compared to the energy scales of processes studied at the ATLAS
  experiment.

  The \taulepton mass can be used directly as a feature by considering
  the invariant mass of the reconstructed secondary particles
  associated to a \tauhadvis candidate. Ignoring reconstruction
  effects, the invariant mass of the visible decay products of \tauhad
  is bounded by the \taulepton mass. This is not the case for
  \tauhadvis candidates originating from quark- or gluon-initiated
  jets which do not have a strict bound.

  The other features, described hereafter, are consequences of, or
  closely related to the mass of the \taulepton.

\item[Particle multiplicity] Hadronic decays of \tauleptons produce
  few (visible) daughter particles. Most decays produce one or three
  charged hadrons (most frequently $\pi^{\pm}$) and zero to two
  neutral pions.
  % Ellis, Stirling, Webber: 6.4 Quark and gluon jet differences
  In contrast, the average multiplicity of charged and neutral
  particles inside of jets originating from the fragmentation of
  partons produced in hard scattering interactions is large and
  increases with the momentum of the
  jet~\cite{Ellis:1996mzs,STDM-2015-12}. Therefore, requirements on
  (charged) particle multiplicties are effective at rejecting
  \tauhadvis candidates originating from quark- or gluon-initiated
  jets.\footnote{Gluon-initiated jets have, on average, a larger
    particle multiplicity and a broader angular distribution of
    particles compared to quark-initiated jets due to the larger
    effective colour charge of
    gluons~\cite{Ellis:1996mzs}. Consequently, quark-initiated jets
    are more likely to be reconstructed and mis-identified as
    \tauhadvis candidates.}

\item[Collimated daughter particles] Analyses typically consider
  \tauhadvis candidates with transverse momenta exceeding
  \SI{20}{\GeV}. At these momentum scales the decay products of
  \tauleptons are collimated due to the Lorentz boost of the lepton,
  leading to the characteristic signature of a narrow jet with few
  visible particles. Requirements on the isolation of \tauhadvis
  candidates allow to reject candidates originating from quark- or
  gluon-initiated jets which have wider angular distribution of
  hadrons.

  % Mean flight path of a p = 20 GeV tau is
  % L = beta * gamma * c * tau = p/m0 * 87mu ~ 1mm
\item[\taulepton lifetime] The \taulepton has a proper lifetime of
  \SI{2.9e-13}{\second}
  ($c \tau = \SI{87}{\micro\metre}$)~\cite{pdg2020} and can thus
  travel for a few millimetres before decaying. The macroscopic
  distance traversed by the \taulepton before decaying produces a
  decay vertex that is displaced from the primary vertex (PV) of the
  hard interaction. For \taulepton decay modes with three charged
  hadrons, this secondary vertex can be reconstructed to determine its
  displacement from the PV. The secondary vertex cannot be
  reconstructed for decay modes with only one charged hadron. However,
  the longitudinal and transverse impact parameters of the track of
  the charged hadron can be used to gauge to incompatibility of the
  track with the PV, thus being sensitive to displaced decays of
  \tauleptons.

  Features related to the lifetime of the \taulepton can be used to
  distingush them from \tauhadvis candidates from quarks- or
  gluon-initiated jets as the hadrons constituting a jet are produced
  promptly at the PV of the interaction.
\end{description}
Prior to the introduction of the method described in this chapter, the
ATLAS collaboration used BDTs as binary classifiers using high-level
discriminating variables, i.e.\ variables purposefully constructed for
the classification task, as inputs.

This chapter introduces a method of performing \tauid using neural
networks that combines the information of high-level discriminating
variables with information from reconstructed charged-particle tracks
and clusters of energy in the calorimeters associated to \tauhadvis
candidates. The number of associated tracks and clusters varies
between candidates requiring the use of neural network architectures
able to process sequences of varying length. This is achieved by
employing a recurrent neural network (RNN) architecture. The method
will be referred to as RNN \tauid hereafter.

The RNN \tauid algorithm was initially proposed in
Ref.~\cite{cdeutsch-master} motivated by a similar approach developed
for track impact parameter based
$b$-tagging~\cite{ATL-PHYS-PUB-2017-003}. The algorithm was
implemented in the reconstruction software of the ATLAS
collaboration~\cite{ATL-SOFT-PUB-2021-001} and the results presented
in this chapter were partially published in
Ref.~\cite{ATL-PHYS-PUB-2019-033}. The RNN \tauid was adopted by the
ATLAS collaboration as the recommended \tauid algorithm for analyses
using the \SI{139}{\per\femto\barn} $pp$-collision dataset recorded
with the ATLAS detector during Run~2 of the LHC.

This chapter is structured as follows. First,

\Cref{sec:tauid_mc}

\Cref{sec:tauid_rnn}

\Cref{sec:tauid_perf}

\Cref{sec:tauid_conclusion}


\section{Simulated Event Samples}%
\label{sec:tauid_mc}

The tau reconstruction and identification algorithms employed at the
ATLAS experiment for Run~2 of the LHC were developed using simulated
events that provide samples of \tauhadvis candidates. For \tauid,
simulated $\gammastar \to \tautau$ and di-jet events are used to yield
samples of true- and \faketauhadvis, respectively.

% y->tautau:
% https://gitlab.cern.ch/atlas-physics/pmg/infrastructure/mc15joboptions/-/blob/master/share/DSID425xxx/MC15.425200.Pythia8EvtGen_A14NNPDF23LO_Gammatautau_MassWeight.py
An artificial $\gammastar \to \tautau$ event sample was generated
using \PYTHIA[8.212]~\cite{Sjostrand:2014zea} for the matrix element
calculation at leading order (LO), parton showering, hadronisation,
and \taulepton decays. The contribution of the $Z$ boson propagator to
the hard scattering process was removed to provide an unpolarised
sample of \tauleptons. In addition, the cross-section of the process
was modified at generator-level to enhance the number of events with
high invariant $\tautau$ masses to increase the number of \tauhadvis
candidates with high transverse momenta. Finally, both \tauleptons are
enforced to decay hadronically to maximise statistical precision of
the \truetauhadvis sample for \tauid developments.

% Di-jet samples: JZ1W up to JZ6W
% https://gitlab.cern.ch/atlas-physics/pmg/infrastructure/mc15joboptions/-/blob/master/share/DSID361xxx/MC15.361021.Pythia8EvtGen_A14NNPDF23LO_jetjet_JZ1W.py
Di-jet events are generated using
\PYTHIA[8.186]~\cite{Sjostrand:2014zea} for the matrix element
calculation at LO, parton showering, and hadronisation. The generation
is performed in slices of \pT of the leading jet (anti-\kt with
$R = 0.6$) constructed from generator-level particles. Slices with
large jet transverse momenta are oversampled to increase the number of
events with high transverse momentum jets (\faketauhadvis).

The $\gammastar \to \tautau$ and di-jet samples use the A14 set of
tuned parameters for \PYTHIA[8]~\cite{ATL-PHYS-PUB-2014-021} and the
\NNPDF[2.3lo]~\cite{Ball:2012cx} set of parton distribution functions.
Decays of hadrons containing $b$- or $c$-quarks are simulated using
\EVTGEN[v1.2.0]~\cite{Lange:2001uf}. The contamination of the hard
scattering interaction with soft, inelastic proton--proton collision
events (pile-up) is accounted for by overlaying the event with
additional minimum-bias events. The response of the ATLAS detector is
simulated for all events~\cite{SOFT-2010-01} which are then
reconstructed using the \textsc{Athena} software
suite~\cite{ATL-SOFT-PUB-2021-001}.


\subsection{\tauhadvis Candidate Selection}

The simulated events are used to construct large samples of \tauhadvis
candidates for the development \tauid algorithms and performance
evaluation. Only \tauhadvis candidates passing the reconstruction are
considered and the following selections are applied:
\begin{itemize}

\item The number of charged particle tracks associated to the
  \tauhadvis candidate, \Ntracks, is either 1 or 3. Candidates with
  one or three associated tracks are referred to as 1- and 3-prong
  \tauhadvis candidates, respectively.

\item The (visible) transverse momentum of the candidate needs to
  fulfil $\pT > \SI{20}{\GeV}$.

\item The \tauhadvis candidate needs to be within $|\eta| < 2.5$ but
  outside of $1.37 < |\eta| < 1.52$, which is the transition region
  between between the barrel and endcap electromagnetic calorimeters.

\end{itemize}
In addition, reconstructed \tauhadvis candidates from
$\gammastar \to \tautau$ events are required to be geometrically
matched to a \tauhad at generator-level within a cone of
$\Delta R < 0.2$.
% And the reco cuts are required to be fulfilled at truth-level.
All efficiencies and rejection rates given in the remainder of this
chapter do not include the effect of these selections.

The $\gammastar \to \tautau$ and di-jet events provide samples of
true- and \faketauhadvis with a size of 20 million and 46 million
candidates, respectively. The distributions of \tauhadvis candidate
\pT is shown for both samples and separately for 1- and 3-prong
candidates in~\Cref{fig:tauid_candidate_pt}. The difference in \pT
spectra between 1- and 3-prong \truetauhadvis in
\Cref{fig:tauid_candidate_pt_gammastar} result from a reduction in
track association efficiency for 3-prong \tauhadvis candidates with
increasing candidate \pT due to the decrease in angular separation of
charged hadrons from the \taulepton decay. In contrast, the \pT
spectrum of 3-prong \tauhadvis candidates from di-jet events, depicted
in \Cref{fig:tauid_candidate_pt_dijet}, shows a comparatively heavier
tail towards large \pT due to the increase in the average charged
particle multiplicity in jets with increasing jet \pT. For the
development of \tauid algorithms, the sample of \faketauhadvis
candidates is re-weighted, separately for 1- and 3-prong candidates,
to match the \pT spectrum of \truetauhadvis from
$\gammastar \to \tautau$.

\begin{figure}[htbp]
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/taupt_gammastar}
    \subcaption{True-\tauhadvis from $\gammastar \to \tautau$ events}%
    \label{fig:tauid_candidate_pt_gammastar}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/taupt_dijet}
    \subcaption{Fake-\tauhadvis from di-jet events}%
    \label{fig:tauid_candidate_pt_dijet}
  \end{subfigure}

  \caption{Transverse momentum of 1- and 3-prong \tauhadvis candidates
    in $\gammastar \to \tautau$ (a) and di-jet events (b). Statistical
    uncertainties are shown as coloured bands surrounding the central
    value. Figures taken from Ref.~\cite{ATL-PHYS-PUB-2019-033}.}%
  \label{fig:tauid_candidate_pt}
\end{figure}


\section{Tau Identification with Recurrent Neural Networks}%
\label{sec:tauid_rnn}

The RNN \tauid exploits the discrimination power of both high- and
low-level inputs to distinguish \tauhad from quark- or gluon-initiated
jets. This approach avoids a possible loss of information relevant to
\tauid when manually constructing high-level variables from low-level
inputs. Specifically, charged-particle tracks and clusters of energy
in the calorimeters, hereafter abbreviated as tracks and clusters, are
included as low-level inputs to the algorithm. The inclusion of tracks
and clusters targets the differences in charged and neutral hadron
multiplicities and track- and calorimeter-based isolation between
true- and \faketauhadvis. Tau identification is performed separately
for 1- and 3-prong \tauhadvis candidates due to their distinct
signatures.


\subsection{Input Variables}

The input variables included in the RNN \tauid algorithm are
summarised in~\Cref{tab:tauid_input_variables}. Three distinct
categories of inputs are considered. High-level inputs correspond to
observables directly associated to \tauhadvis candidates. Track and
cluster inputs refer to observables of tracks and clusters that are
associated to a \tauhadvis candidate. In the following, a description
of the input variable selection and track/cluster association is
given.

\begin{table}[htbp]
  \centering

  \caption{Summary of input variables used for 1- and 3-prong RNN
    \tauid. The table is adapted from
    Ref.~\cite{ATL-PHYS-PUB-2019-033}. Definitions of geometrical
    TopoCluster moments ($\lambda$, $\langle \lambda^2 \rangle$,
    $\langle r^2 \rangle$) are given in Ref.~\cite{PERF-2014-07}. The
    local hadronic calibration~\cite{PERF-2014-07} is used to
    calibrate jets, clusters, and \tauhadvis candidates unless
    otherwise noted. Variables using cell-level calorimeter
    information only consider cells that are part of TopoClusters for
    noise suppression. $\dagger$:~Energy depositions in the
    pre-sampler and first two layers of the electromagnetic
    calorimeters that are part of TopoClusters are abbreviated as ``EM
    clusters''.}%
  \label{tab:tauid_input_variables}

  \resizebox{0.99\textwidth}{!}{
    \input{tables/tauid_inputs}
  }
\end{table}

\subsubsection{High-Level Input Variables}

The selection of high-level input variables is based on a BDT-based
\tauid algorithm developed by the ATLAS
collaboration~\cite{ATL-PHYS-PUB-2015-045} and updated in
Ref.~\cite{cdeutsch-master} for new \tauhadvis reconstruction methods
deployed during Run~2 of the LHC. The BDT \tauid uses the high-level
variables summarised in~\Cref{tab:tauid_input_variables} as inputs and
serves as a baseline for comparison with the RNN-based algorithm.

Variables sensitive to the lifetime and mass of the \taulepton
($|S_{\text{T}}^{\text{flight}}|$, $|S_{\text{leadtrack}}|$,
$m^{\text{track}}$), the isolation of \tauhadvis in the tracking
system ($f_{\text{iso}}^{\text{track}}$) and the calorimeters
($f_{\text{cent}}$), and combinations of track- and calorimeter-based
isolation ($f_{\text{track}}^{\text{EM}}$,
$p_{\text{T}}^{\text{EM+track}} / \pT$) are among the most important
high-level variables included in the \tauid algorithms. Three
exemplary distributions are shown in~\Cref{fig:tauid_high_level_vars}.


\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_sumpttrkfrac_1P}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_ptratioeflowapprox_1P}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_masstrksys_3P}
    \subcaption{}
  \end{subfigure}

  \caption{Distributions of exemplary high-level input variables used
    for \tauid. (a):~The ratio of the scalar sum of \pT of tracks
    classified as \emph{isolation} with respect to tracks classified
    as \emph{core} or \emph{isolation}. (b):~The ratio of \tauhadvis
    candidate \pT estimated using a simplified particle flow approach
    and the purely calorimeter-based measurement
    (cf.~\Cref{tab:tauid_input_variables}). (c):~The mass of the
    system of \emph{core} tracks for 3-prong \tauhadvis candidates.}%
  \label{fig:tauid_high_level_vars}
\end{figure}


\subsubsection{Track Input Variables}

Reconstructed tracks within $\Delta R < 0.4$ of the \tauhadvis
candidate axis with $\pT > \SI{500}{\MeV}$ are considered as inputs to
the RNN \tauid. No selections are applied on the quality of
reconstructed tracks or track impact parameters, thus the input tracks
include fake tracks and tracks from pile-up. Instead, track quality
criteria ($N_{\text{IBL hits}}$, $N_{\text{Pixel hits}}$,
$N_{\text{SCT hits}}$) and track impact parameters
($|d_0^{\text{track}}|$, $|z_0^{\text{track}} \sin\theta|$) are
included as observables of tracks used in the RNN \tauid algorithm
directly.

The transverse momenta of tracks ($p_{\text{T}}^{\text{track}}$) and
their angular separation from the axis of the \tauhadvis candidate
($\Delta \eta^{\text{track}}$, $\Delta \phi^{\text{track}}$) are
included to probe the isolation properties of \tauhadvis. A special
case is represented by the $p_{\text{T}}^{\text{seed jet}}$ variable,
the \pT of the jet seeding the \tauhadvis candidate, which is included
as an observable with every track. This input variable provides an
approximate \pT-scale of the underlying jet (or \tauhadvis) already
when processing the input tracks. Exemplary distributions of the
transverse momenta of the three \pT-leading tracks for 1-prong
\tauhadvis candidates are shown
in~\Cref{fig:tauid_low_level_variables_track0,fig:tauid_low_level_variables_track1,fig:tauid_low_level_variables_track2}.

\begin{figure}[htbp]
  \centering

  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_trk0relpt_1P}
    \subcaption{}%
    \label{fig:tauid_low_level_variables_track0}
  \end{subfigure}%
  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_trk1relpt_1P}
    \subcaption{}%
    \label{fig:tauid_low_level_variables_track1}
  \end{subfigure}%
  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_trk2relpt_1P}
    \subcaption{}%
    \label{fig:tauid_low_level_variables_track2}
  \end{subfigure}

  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_cls0relet_3P}
    \subcaption{}%
    \label{fig:tauid_low_level_variables_cluster0}
  \end{subfigure}%
  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_cls1relet_3P}
    \subcaption{}%
    \label{fig:tauid_low_level_variables_cluster1}
  \end{subfigure}%
  \begin{subfigure}{0.33\textwidth}
    \includegraphics[width=\textwidth]{tauid/invars/invars_cls2relet_3P}
    \subcaption{}%
    \label{fig:tauid_low_level_variables_cluster2}
  \end{subfigure}

  \caption{Transverse momentum of the three \pT-leading tracks
    associated to 1-prong \tauhadvis candidates (a-c). Transverse
    energy of the three \ET-leading clusters associated to 3-prong
    \tauhadvis candidates (d-f). For illustration purposes, the track
    \pT and cluster \ET are normalised to the \pT of the jet seeding
    the \tauhadvis reconstruction.}%
  \label{fig:tauid_low_level_variables}
\end{figure}

The discrimination power of the RNN \tauid saturates after including
the ten tracks leading in \pT. Therefore, the sequence of tracks is
truncated at this point due to practical considerations.


\subsubsection{Cluster Input Variables}

Topological clusters of energy in the calorimeters are considered as
inputs to the RNN \tauid if they are constitutents of the jet seeding
the \tauhadvis reconstruction. All clusters are calibrated using the
local hadronic calibration~\cite{PERF-2014-07}.

The inclusion of the $E_{\text{T}}^{\text{cluster}}$,
$\Delta \eta^{\text{cluster}}$, $\Delta \phi^{\text{cluster}}$, and
$p_{\text{T}}^{\text{jet seed}}$ observables
(cf.~\Cref{tab:tauid_input_variables}) follow from considerations
similar to those for charged-particle tracks. In addition, information
on the position and shape of showers in the calorimeters is included
in the form of cluster moments~\cite{PERF-2014-07}, targeting the
differences between electromagnetic and hadronic showers. These
cluster moments include the longitudinal location of the cluster
barycentre, $\lambda_{\text{cluster}}$, and the lateral and
longitudinal extension of the cluster,
$\langle r^2 \rangle_{\text{cluster}}$ and
$\langle \lambda^2 \rangle_{\text{cluster}}$, respectively. The \ET of
the three \ET-leading clusters is shown
in~\Cref{fig:tauid_low_level_variables_cluster0,fig:tauid_low_level_variables_cluster1,fig:tauid_low_level_variables_cluster2}
for 3-prong \tauhadvis candidates.

The performance of the RNN \tauid saturates after the inclusion of the
six \ET-leading clusters, thus the sequence of input clusters is
truncated at this point.


\subsection{Network Architecture and Training}

The network architecture used for the RNN \tauid is motivated by the
choice of inputs. The three types of inputs are processed
independently at first, resulting in a three branch structure, and
later combined yielding a classification score. A schematic depiction
of the architecture is given in~\Cref{fig:tauid_network_architecture}
and will be discussed in more detail in the following.

\begin{figure}[htbp]
  \centering

  \includegraphics[width=0.95\textwidth]{tauid/pubnote/rnn_network_architecture}

  \caption{Schematic depiction of the architecture used for the RNN
    \tauid algorithm. The figure is taken from
    Ref.~\cite{ATL-PHYS-PUB-2019-033}.}%
  \label{fig:tauid_network_architecture}
\end{figure}

The branch of the network processing high-level input variables
consists of three fully-connected (\emph{dense}) layers with 128, 128,
and 16 neurons each. All layers include trainable bias vectors and use
the ReLU~\cite{nair:relu} activation function.

Tracks and clusters are provided as sequences of vectors of
observables to the network. The sequences of tracks and clusters are
ordered by descending $p_{\text{T}}^{\text{track}}$ and
$E_{T}^{\text{cluster}}$, respectively. The configuration of the
branches processing tracks and clusters are identical. First,
sequences of tracks and clusters are passed through two
fully-connected layers with shared weights (\emph{shared dense}), 32
neurons each, trainable bias vectors, and using ReLU~\cite{nair:relu}
activation functions. \emph{Shared dense} layers map sequences of
input vectors, $(\myvec{x}_i)_{i=1}^{n}$, to sequences of output
vectors of the same length, $(\myvec{y}_i)_{i=1}^{n}$, using a
transformation of the form
\begin{align*}
  \myvec{y}_i = \myvec{\phi}(\myvec{W} \myvec{x}_i + \myvec{b}) \,\text{,}
\end{align*}
where $\myvec{W}$ and $\myvec{b}$ are trainable weight matrices and
bias vectors, respectively, and $\myvec{\phi}$ is the activation
function.  Notably, the weights and biases do not depend on the
sequence index $i$, i.e.~both are shared across all elements of the
sequence. The \emph{shared dense} layers produce intermediate
representations of the sequences of tracks and clusters for further
processing.

The transformed sequences of tracks and clusters are further processed
by two recurrent layers based on the \emph{long short-term memory}
(LSTM) architecture~\cite{lstm}. The first LSTM layer maps the input
sequence to an output sequence of the same length. In contrast to
\emph{shared dense} layers which perform a similar mapping, LSTM
layers have an internal state that is updated as elements of the
sequence are processed. As a result, information on elements occuring
earlier in the sequence is used when processing later elements. The
second LSTM layer repeats the process, however, all except the last
element of the output sequence are discarded. This effectively encodes
the input sequence into a vector of fixed size. The size of the
internal state and the outputs of the LSTM are chosen to be the same
and correspond to 32 neurons for the first and 24 neurons for the
second LSTM layer.

Finally, the results from the three branches are concatenated
(\emph{Merge}) and passed through three fully-connected layers with
64, 32, and 1 neurons.

All ReLU except for LSTM.  Bias vectors used everywhere. Model
consists of approximately 56000 trainable parameters.


- High-level variables are supplied at the level of individual tau
leptons thus a simple densely connected architecture is chosen for the
processing of these inputs.

- Tracks and clusters can be seen as a sequence of objects on which a
physically motivated ordering is imposed.

- Recurrent neural network architecture to process sequences of length
varying from event to event.

 % Layers of the network are indicated by boxes.

 %    Layers are represented as boxes with \emph{dense} (\emph{shared
 %      dense}) layers corresponding densely connected layers (with
 %    shared weights). The recurrent neural network architecture
 %    processing sequences of tracks and clusters is established by long
 %    short-term memory (LSTM) layers. A merge operation combines the
 %    three branches of the network by concatenating their outputs.


\subsection{Training and evaluation}

These samples are partitioned into a
training (\SI{40}{\percent}), validation (\SI{10}{\percent}), and
testing dataset (\SI{50}{\percent}).

Keras Tensorflow lwtnn \cite{lwtnn,keras,tensorflow2015-whitepaper,lstm}

Used in the software suite
\textsc{Athena}~\cite{ATL-SOFT-PUB-2021-001}.

\subsection{Working Point Definition}

\subsubsection{Calibration}

The efficiencies of the loose, medium, and tight working point for
\truetauhadvis were calibrated by the ATLAS collaboration using
$Z \to \tau_\mu \tauhad$ tag-and-probe showing agreement (within X
percent) between the predicted efficiency by simuation and the
efficiencies measured using collision data.


\section{Tau Identification Performance}
\label{sec:tauid_perf}

\begin{figure}[htbp]
  \centering

  % \includegraphics[width=0.55\textwidth]{tauid/pubnote/rnn_bdt_roc}
  \includegraphics[width=0.55\textwidth]{tauid/roc_incl_witherrors}

  \caption{Receiver operating characteristic of the RNN
    \tauhad-identification algorithm \cite{ATL-PHYS-PUB-2019-033}}%
  \label{fig:tauid_rnn_bdt_roc_comparison}
\end{figure}


\begin{table}
  \centering

  \caption{List of defined working points with fixed true \tauhadvis
    selection efficiencies and the corresponding background rejection
    factors for misidentified \tauhadvis in dijet events for the BDT
    and RNN classifiers. Adapted from~\cite{ATL-PHYS-PUB-2019-033}.}%
  \label{tab:rnn_wps}

  \input{tables/tauid_working_points}
\end{table}


\begin{figure}[htbp]

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_pt_1p}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_pt_3p}
    \subcaption{}
  \end{subfigure}

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_eta_1p}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_eta_3p}
    \subcaption{}
  \end{subfigure}

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_mu_1p}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_mu_3p}
    \subcaption{}
  \end{subfigure}

  \caption{Eff. Figures are taken from
    Ref.~\cite{ATL-PHYS-PUB-2019-033}.}
  \label{fig:tauid_truetau_eff}
\end{figure}





\subsection{Use at the HLT?}

\cite{ATL-DAQ-PUB-2019-001}


\section{Conclusion and Outlook}
\label{sec:tauid_conclusion}


To be replaced by ``deep sets'' (permutation invariance). Based on the
same idea and same expected performance but significantly improved
training and prediction time.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../phd_thesis"
%%% End:
