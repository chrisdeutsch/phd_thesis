\section{Expected Performance of Tau Identification with RNN}%
\label{sec:tauid_perf}

Thresholds on the RNN scores of 1- and 3-prong \tauhadvis candidates define
working points of varying \tauhadvis identification efficiencies and
\faketauhadvisC rejection factors.\footnote{The \tauhadvis identification
  efficiency is the fraction of \truetauhadvis from simulated
  $\gammastar \to \tautau$ events that pass a given working point. The
  \faketauhadvisC rejection is the reciprocal of the fraction of \faketauhadvis
  from simulated dijet events that pass a given working point.} Four named
working points are defined to cover the needs of most physics analyses at the
ATLAS experiment. These working points are, in order of increasing
\faketauhadvisC rejection: \emph{very loose}, \emph{loose}, \emph{medium}, and
\emph{tight}.

The targeted \tauhadvis identification efficiencies of the working points are
summarised in \Cref{tab:rnn_wps}. The rejection of \faketauhadvis from simulated
dijet events is compared between the BDT- and RNN-based \tauid algorithms for
working points targeting the same \tauhadvis efficiency. The RNN \tauid improves
the \faketauhadvisC rejection by about \SI{80}{\percent} for 1-prong and between
\SIrange[range-units=single]{40}{80}{\percent} for 3-prong \tauhadvis candidates over the BDT-based
method. The majority of these improvements stem from the inclusion of
charge-particle track information in addition to the high-level variables also
used in the BDT. The \emph{receiver operating characteristic curves} of both
algorithms are shown in \Cref{fig:tauid_rnn_bdt_roc_comparison}.

\begin{table}[htbp]
  \centering

  \caption[Comparison of working points defined for the BDT- and RNN-based
  \tauid.]{Comparison of working points defined for the BDT- and RNN-based
    \tauid. Only the targeted \tauhadvis efficiency (target \tauhadvis eff.) of
    the working points is given, which can deviate by ca.\ \SI{1}{\percent} from
    the efficiency observed in simulated $\gammastar \to \tautau$ events. The
    \faketauhadvisC rejection is evaluated using the \tauhadvis candidate sample
    from dijet events.}%
  \label{tab:rnn_wps}

  \input{tables/tauid_working_points}
\end{table}

\begin{figure}[htbp]
  \centering

  \includegraphics[width=0.55\textwidth]{tauid/roc_incl_witherrors}

  \caption[Receiver operating characteristic curves of the \tauid algorithms
  based on RNN and BDT.]{Receiver operating characteristic curves of the \tauid
    algorithms based on RNN (solid) and BDT (dashed) shown separately for
    1-prong (red) and 3-prong (blue) \tauhadvis candidates. The true- and
    \faketauhadvisC efficiencies are evaluated using samples of \tauhadvis
    candidates from $\gammastar \to \tautau$ and dijet events, respectively.}%
  \label{fig:tauid_rnn_bdt_roc_comparison}
\end{figure}

The \tauhadvis identification efficiencies
% estimated using \tauhadvis from simulated $\gammastar \to \tautau$ events
are shown in \Cref{fig:tauid_truetau_eff} for all four working points in bins of
\tauhadvis \pT, \tauhadvis $|\eta|$, and the average number of interactions per
bunch crossing, $\mu$. The efficiency remains approximately constant as
\tauhadvis \pT and $\mu$ is varied due to the definition of the working points
using the transformed output of the neural network. An exception is the first
\tauhadvis \pT bin which does not meet the target efficiency. This is an effect
of different \tauhadvis momentum calibrations being used for the transformation
of the RNN output and for the performance evaluation shown in
\Cref{fig:tauid_truetau_eff_a,fig:tauid_truetau_eff_b}. The transformation was
derived using the calorimeter-based \tauhadvis \pT estimate at LC scale, which
is now superseded by a multivariate method combining information from the
calorimeters and tracking systems (shown in the figures).

\begin{figure}[htbp]

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_pt_1p}
    \subcaption{}%
    \label{fig:tauid_truetau_eff_a}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_pt_3p}
    \subcaption{}%
    \label{fig:tauid_truetau_eff_b}
  \end{subfigure}

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_eta_1p}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_eta_3p}
    \subcaption{}
  \end{subfigure}

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_mu_1p}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/eff_vs_mu_3p}
    \subcaption{}
  \end{subfigure}

  \caption[True-\tauhadvis efficiencies of the RNN \tauid working
  points.]{True-\tauhadvis efficiencies of the RNN \tauid working points. The
    efficiencies are estimated using \tauhadvis candidates from simulated
    $\gammastar \to \tautau$ events separately for 1-prong (left) and 3-prong
    (right) \tauhadvis. Efficiencies are shown in bins of \tauhadvis \pT (top),
    \tauhadvis $|\eta|$ (middle), and the average number of interactions per
    bunch crossing (bottom). All figures are taken from
    Ref.~\cite{ATL-PHYS-PUB-2019-033}.}%
  \label{fig:tauid_truetau_eff}
\end{figure}

The rejection of \faketauhadvis from simulated dijet events by the \emph{medium}
\tauid working points of the BDT- and RNN-based methods is compared
in~\Cref{fig:tauid_faketau_rej}. The comparison is performed separately for 1-
and 3-prong \tauhadvis candidates and in bins of \tauhadvis \pT, \tauhadvis
$|\eta|$, and $\mu$. In general, the \faketauhadvisC rejection of \tauid is
analysis and process dependent\footnote{The ratio of quark- to gluon-initiated
  jets affects the \faketauhadvisC rejection since gluon-initiated jets are more
  easily rejected by \tauid. Additionally, the rejection depends on the \pT and
  \Ntracks of \faketauhadvis and thus on the selections applied by analyses.}
and thus the comparison mainly serves as a benchmark of the identification
algorithms.

The \faketauhadvisC rejection of \tauid increases with \tauhadvis
candidate \pT, as is shown in
\Cref{fig:tauid_faketau_rej_a,fig:tauid_faketau_rej_b}. This trend is
partially explained by the increasing discrimination power of
variables sensitive to the isolation of \tauhadvis candidates as
larger momentum scales are considered. This is a consequence of the
increasing collimation of \truetauhadvis due to the Lorentz boost of
the \taulepton, while \faketauhadvis become less isolated due to the
increase in the average charged and neutral hadron multiplicity in
jets.

% Improved discrimination power is also expected for variables
% sensitive to the \taulepton lifetime for 3-prong \tauhadvis where
% the secondary vertex will, on average, have a larger displacement
% from the PV.

The RNN \tauid improves the \faketauhadvisC rejection by a factor of
two for 1- and 3-prong \tauhadvis candidates with
$\pT > \SI{70}{\GeV}$ over the BDT-based approach at comparable
working points. Similar behaviour of the \faketauhadvisC rejection is
observed for both methods with respect to the pseudorapidity of
\tauhadvis candidates. However, the RNN \tauid is more susceptible to
pile-up compared to the BDT-based method. This is depicted
in~\Cref{fig:tauid_faketau_rej_e,fig:tauid_faketau_rej_f} showing a
degradation in \faketauhadvisC rejection as the average number of
interactions per bunch crossing increases.

\begin{figure}[htbp]

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/rej_vs_pt_1p}
    \subcaption{}%
    \label{fig:tauid_faketau_rej_a}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/rej_vs_pt_3p}
    \subcaption{}%
    \label{fig:tauid_faketau_rej_b}
  \end{subfigure}

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/rej_vs_eta_1p}
    \subcaption{}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/rej_vs_eta_3p}
    \subcaption{}
  \end{subfigure}

  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/rej_vs_mu_1p}
    \subcaption{}%
    \label{fig:tauid_faketau_rej_e}
  \end{subfigure}\hfill%
  \begin{subfigure}{0.498\textwidth}
    \includegraphics[width=\textwidth]{tauid/pubnote/rej_vs_mu_3p}
    \subcaption{}%
    \label{fig:tauid_faketau_rej_f}
  \end{subfigure}

  \caption[Fake-\tauhadvis rejection of the \emph{medium} RNN and BDT \tauid
  working points.]{Fake-\tauhadvis rejection of the \emph{medium} RNN (red) and
    BDT (blue) \tauid working points. The rejection is shown separately for
    1-prong (left) and 3-prong (right) \tauhadvis candidates in bins of \pT
    (top), $|\eta|$ (middle) of \tauhadvis candidates, and the average number of
    interactions per bunch crossing, $\mu$, for the event (bottom). The
    rejection is estimated using a sample of \tauhadvis candidates from
    simulated dijet events. All figures are taken from
    Ref.~\cite{ATL-PHYS-PUB-2019-033}.}%
  \label{fig:tauid_faketau_rej}
\end{figure}

Data-driven measurements of the \tauhadvis identification efficiencies of
selected RNN \tauid working points (\emph{loose}, \emph{medium}, and
\emph{tight}) were performed by the ATLAS collaboration. The measurements used
the tag-and-probe method in $Z \to \tau_\mu \tauhad$ events and have provided
calibrations of the \tauhadvis selection efficiencies in simulation. A relative
agreement within \SI{5}{\percent} is observed between the efficiency predicted
by simulation and the central value of the data-driven measurement.
% \footnote{A similar level of agreement is observed in the \tauhadvis
% identification efficiency measurements for the BDT-based algorithm.}
Both agree within the statistical and systematic uncertainties of the
measurement, showing acceptable modelling of the \tauid decisions thresholds in
simulation even after including low-level information from charged-particle
tracks and topo-clusters.

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../phd_thesis"
%%% End:
